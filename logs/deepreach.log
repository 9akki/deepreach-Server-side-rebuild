2025-11-11 18:47:14 [main] INFO  c.deepreach.web.DeepReachApplication - Starting DeepReachApplication using Java 17.0.12 with PID 48214 (/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/deepreach-web/target/classes started by gak1 in /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild)
2025-11-11 18:47:14 [main] DEBUG c.deepreach.web.DeepReachApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-11 18:47:14 [main] INFO  c.deepreach.web.DeepReachApplication - The following 1 profile is active: "dev"
2025-11-11 18:47:15 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-11 18:47:15 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-11 18:47:15 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-11-11 18:47:15 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-11 18:47:15 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-11 18:47:15 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-11 18:47:16 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-11 18:47:16 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 986 ms
2025-11-11 18:47:16 [main] DEBUG c.d.c.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-11-11 18:47:16 [main] ERROR i.n.r.d.DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
2025-11-11 18:47:16 [main] INFO  c.d.w.s.impl.FileStorageServiceImpl - 文件上传目录: /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 18:47:16 [main] INFO  c.d.message.worker.SmsSendWorker - SmsSendWorker started
2025-11-11 18:47:17 [main] INFO  c.deepreach.web.config.WebMvcConfig - 静态资源映射配置：/uploads/** -> file:/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 18:47:17 [main] INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@6fa2d0b2, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@49c37918, org.springframework.security.web.context.SecurityContextHolderFilter@59263f7b, org.springframework.security.web.header.HeaderWriterFilter@35198da3, org.springframework.web.filter.CorsFilter@43de88f3, org.springframework.security.web.authentication.logout.LogoutFilter@5d8a1456, com.deepreach.common.security.JwtAuthenticationFilter@1ef93e01, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@447a557b, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@7cab8d52, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@347c5721, org.springframework.security.web.session.SessionManagementFilter@7bc4ac3e, org.springframework.security.web.access.ExceptionTranslationFilter@5b4b6f3b, org.springframework.security.web.access.intercept.AuthorizationFilter@72998021]
2025-11-11 18:47:17 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-11 18:47:17 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'org.springframework.kafka.config.internalKafkaListenerEndpointRegistry'
2025-11-11 18:47:17 [main] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-0} closing ...
2025-11-11 18:47:17 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-11-11 18:47:17 [main] ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.context.ApplicationContextException: Failed to start bean 'org.springframework.kafka.config.internalKafkaListenerEndpointRegistry'
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:287)
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:467)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:256)
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:201)
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:965)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:619)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.deepreach.web.DeepReachApplication.main(DeepReachApplication.java:37)
Caused by: java.lang.IllegalStateException: JsonDeserializer must be configured with property setters, or via configuration properties; not both
	at org.springframework.util.Assert.state(Assert.java:76)
	at org.springframework.kafka.support.serializer.JsonDeserializer.configure(JsonDeserializer.java:406)
	at org.springframework.kafka.core.DefaultKafkaConsumerFactory.lambda$valueDeserializerSupplier$9(DefaultKafkaConsumerFactory.java:194)
	at org.springframework.kafka.core.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer.<init>(DefaultKafkaConsumerFactory.java:486)
	at org.springframework.kafka.core.DefaultKafkaConsumerFactory.createRawConsumer(DefaultKafkaConsumerFactory.java:468)
	at org.springframework.kafka.core.DefaultKafkaConsumerFactory.createKafkaConsumer(DefaultKafkaConsumerFactory.java:445)
	at org.springframework.kafka.core.DefaultKafkaConsumerFactory.createConsumerWithAdjustedProperties(DefaultKafkaConsumerFactory.java:422)
	at org.springframework.kafka.core.DefaultKafkaConsumerFactory.createKafkaConsumer(DefaultKafkaConsumerFactory.java:389)
	at org.springframework.kafka.core.DefaultKafkaConsumerFactory.createConsumer(DefaultKafkaConsumerFactory.java:366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.<init>(KafkaMessageListenerContainer.java:875)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer.doStart(KafkaMessageListenerContainer.java:380)
	at org.springframework.kafka.listener.AbstractMessageListenerContainer.start(AbstractMessageListenerContainer.java:505)
	at org.springframework.kafka.listener.ConcurrentMessageListenerContainer.doStart(ConcurrentMessageListenerContainer.java:255)
	at org.springframework.kafka.listener.AbstractMessageListenerContainer.start(AbstractMessageListenerContainer.java:505)
	at org.springframework.kafka.config.KafkaListenerEndpointRegistry.startIfNecessary(KafkaListenerEndpointRegistry.java:390)
	at org.springframework.kafka.config.KafkaListenerEndpointRegistry.start(KafkaListenerEndpointRegistry.java:335)
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:284)
	... 13 common frames omitted
2025-11-11 18:48:34 [main] INFO  c.deepreach.web.DeepReachApplication - Starting DeepReachApplication using Java 17.0.12 with PID 48298 (/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/deepreach-web/target/classes started by gak1 in /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild)
2025-11-11 18:48:34 [main] DEBUG c.deepreach.web.DeepReachApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-11 18:48:34 [main] INFO  c.deepreach.web.DeepReachApplication - The following 1 profile is active: "dev"
2025-11-11 18:48:35 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-11 18:48:35 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-11 18:48:35 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 6 ms. Found 0 Redis repository interfaces.
2025-11-11 18:48:35 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-11 18:48:35 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-11 18:48:35 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-11 18:48:35 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-11 18:48:35 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 831 ms
2025-11-11 18:48:35 [main] DEBUG c.d.c.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-11-11 18:48:35 [main] ERROR i.n.r.d.DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
2025-11-11 18:48:36 [main] INFO  c.d.w.s.impl.FileStorageServiceImpl - 文件上传目录: /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 18:48:36 [main] INFO  c.d.message.worker.SmsSendWorker - SmsSendWorker started
2025-11-11 18:48:36 [main] INFO  c.deepreach.web.config.WebMvcConfig - 静态资源映射配置：/uploads/** -> file:/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 18:48:36 [main] INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@5d8a1456, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@351fadfa, org.springframework.security.web.context.SecurityContextHolderFilter@17635531, org.springframework.security.web.header.HeaderWriterFilter@136a4800, org.springframework.web.filter.CorsFilter@7e1953f7, org.springframework.security.web.authentication.logout.LogoutFilter@7dda5b25, com.deepreach.common.security.JwtAuthenticationFilter@2b6b487c, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@396519b, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@18ad085a, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@26f07261, org.springframework.security.web.session.SessionManagementFilter@7f08c343, org.springframework.security.web.access.ExceptionTranslationFilter@7c0b792e, org.springframework.security.web.access.intercept.AuthorizationFilter@4932d580]
2025-11-11 18:48:36 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-11 18:48:37 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 18:48:37 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 18:48:37 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 18:48:37 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 18:48:37 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762858117040
2025-11-11 18:48:37 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Subscribed to topic(s): translation-charge
2025-11-11 18:48:37 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 18:48:37 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 18:48:37 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 18:48:37 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 18:48:37 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762858117050
2025-11-11 18:48:37 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Subscribed to topic(s): translation-charge
2025-11-11 18:48:37 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 18:48:37 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 18:48:37 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 18:48:37 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 18:48:37 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762858117052
2025-11-11 18:48:37 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Subscribed to topic(s): translation-charge
2025-11-11 18:48:37 [main] INFO  c.deepreach.web.DeepReachApplication - Started DeepReachApplication in 2.592 seconds (process running for 2.886)
2025-11-11 18:48:37 [main] INFO  c.d.web.config.DataSourceHealthCheck - 开始检查数据源配置...
2025-11-11 18:48:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 18:48:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 18:48:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 18:48:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 18:48:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 18:48:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] (Re-)joining group
2025-11-11 18:48:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] (Re-)joining group
2025-11-11 18:48:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-1-5292755f-29b0-49ef-8e36-5fc0cd8d5917
2025-11-11 18:48:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 18:48:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] (Re-)joining group
2025-11-11 18:48:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 18:48:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] (Re-)joining group
2025-11-11 18:48:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-3-822fc3b2-5edb-456b-ab95-3197a0cb3598
2025-11-11 18:48:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 18:48:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] (Re-)joining group
2025-11-11 18:48:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-2-2984f68a-03b6-4d81-8354-0f5c87e106a2
2025-11-11 18:48:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 18:48:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] (Re-)joining group
2025-11-11 18:48:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Successfully joined group with generation Generation{generationId=5, memberId='consumer-deepreach-translation-2-2984f68a-03b6-4d81-8354-0f5c87e106a2', protocol='range'}
2025-11-11 18:48:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Successfully joined group with generation Generation{generationId=5, memberId='consumer-deepreach-translation-3-822fc3b2-5edb-456b-ab95-3197a0cb3598', protocol='range'}
2025-11-11 18:48:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Successfully joined group with generation Generation{generationId=5, memberId='consumer-deepreach-translation-1-5292755f-29b0-49ef-8e36-5fc0cd8d5917', protocol='range'}
2025-11-11 18:48:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Finished assignment for group at generation 5: {consumer-deepreach-translation-2-2984f68a-03b6-4d81-8354-0f5c87e106a2=Assignment(partitions=[translation-charge-1]), consumer-deepreach-translation-3-822fc3b2-5edb-456b-ab95-3197a0cb3598=Assignment(partitions=[translation-charge-2]), consumer-deepreach-translation-1-5292755f-29b0-49ef-8e36-5fc0cd8d5917=Assignment(partitions=[translation-charge-0])}
2025-11-11 18:48:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Successfully synced group in generation Generation{generationId=5, memberId='consumer-deepreach-translation-2-2984f68a-03b6-4d81-8354-0f5c87e106a2', protocol='range'}
2025-11-11 18:48:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Notifying assignor about the new Assignment(partitions=[translation-charge-1])
2025-11-11 18:48:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Successfully synced group in generation Generation{generationId=5, memberId='consumer-deepreach-translation-1-5292755f-29b0-49ef-8e36-5fc0cd8d5917', protocol='range'}
2025-11-11 18:48:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Notifying assignor about the new Assignment(partitions=[translation-charge-0])
2025-11-11 18:48:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Adding newly assigned partitions: translation-charge-1
2025-11-11 18:48:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Adding newly assigned partitions: translation-charge-0
2025-11-11 18:48:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Setting offset for partition translation-charge-1 to the committed offset FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 18:48:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Setting offset for partition translation-charge-0 to the committed offset FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 18:48:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Successfully synced group in generation Generation{generationId=5, memberId='consumer-deepreach-translation-3-822fc3b2-5edb-456b-ab95-3197a0cb3598', protocol='range'}
2025-11-11 18:48:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions assigned: [translation-charge-1]
2025-11-11 18:48:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Notifying assignor about the new Assignment(partitions=[translation-charge-2])
2025-11-11 18:48:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Adding newly assigned partitions: translation-charge-2
2025-11-11 18:48:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions assigned: [translation-charge-0]
2025-11-11 18:48:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Setting offset for partition translation-charge-2 to the committed offset FetchPosition{offset=2, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 18:48:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions assigned: [translation-charge-2]
2025-11-11 18:48:46 [main] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-11-11 18:48:47 [main] INFO  c.d.web.config.DataSourceHealthCheck - 主数据源连接成功: PRIMARY_OK
2025-11-11 18:48:48 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据源连接成功: CLOUD_COMPUTER_OK
2025-11-11 18:48:49 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据库中admin用户记录数: 0
2025-11-11 18:48:49 [main] INFO  c.d.web.config.DataSourceHealthCheck - 数据源检查完成
2025-11-11 18:48:49 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 开始构建用户层级树缓存...
2025-11-11 18:48:49 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==>  Preparing: SELECT u.user_id AS userId, u.parent_user_id AS parentUserId FROM sys_user u WHERE u.status = '0'
2025-11-11 18:48:49 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==> Parameters: 
2025-11-11 18:48:49 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - <==      Total: 72
2025-11-11 18:48:49 [main] INFO  c.d.c.c.s.impl.SysUserServiceImpl - 用户层级树缓存刷新成功：记录总数=72, 根节点数量=1
2025-11-11 18:48:49 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 用户层级树缓存构建完成
2025-11-11 18:49:00 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-11 18:49:00 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-11 18:49:00 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-11-11 18:49:00 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 18:49:00 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 18:49:00 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 18:49:00 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 18:49:00 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 18:49:00 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:49:00 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 18:49:00 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 18:49:00 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:49:00 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 18:49:00 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 18:49:00 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 18:49:00 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 18:49:01 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 18:49:01 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 18:49:01 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 18:49:01 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 18:49:01 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 18:49:01 [http-nio-8080-exec-2] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 18:49:01 [http-nio-8080-exec-2] WARN  o.s.w.s.h.HandlerMappingIntrospector - Cache miss for REQUEST dispatch to '/api/translate' (previous null). Performing MatchableHandlerMapping lookup. This is logged once only at WARN level, and every time at TRACE.
2025-11-11 18:49:01 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 18:49:01 [http-nio-8080-exec-2] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 18:49:01 [http-nio-8080-exec-2] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-0
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-0
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 18:49:01 [http-nio-8080-exec-2] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Instantiated a transactional producer.
2025-11-11 18:49:01 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 18:49:01 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 18:49:01 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762858141122
2025-11-11 18:49:01 [http-nio-8080-exec-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 18:49:01 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 18:49:01 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 18:49:02 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] ProducerId set to 0 with epoch 1
2025-11-11 18:49:02 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 18:49:02 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 18:49:02 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 18:49:02 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:49:02 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 18:49:02 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 18:49:02 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:49:02 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 18:49:02 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 18:49:02 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:49:02 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 18:49:02 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 18:49:02 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:49:02 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 18:49:02 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 18:49:02 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 18:49:02 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 18:49:03 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 18:49:05 [http-nio-8080-exec-2] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 119 tokens
2025-11-11 18:49:05 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 18:49:05 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if this is the right one? 😈(String), en(String)
2025-11-11 18:49:05 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 18:49:05 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 18:49:05 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 18:49:05 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 18:49:05 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 18:49:05 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 18:49:06 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 18:49:06 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:49:06 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 18:49:06 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 18:49:06 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:49:06 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 18:49:06 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 18:49:06 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:49:06 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 18:49:06 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 18:49:06 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:49:06 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 18:49:06 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 18:49:06 [http-nio-8080-exec-2] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-1
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-1
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 18:49:06 [http-nio-8080-exec-2] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Instantiated a transactional producer.
2025-11-11 18:49:06 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 18:49:06 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 18:49:06 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762858146652
2025-11-11 18:49:06 [http-nio-8080-exec-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 18:49:07 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 18:49:07 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 18:49:08 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] ProducerId set to 1 with epoch 1
2025-11-11 18:49:10 [http-nio-8080-exec-2] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=c5e675f2-f81d-4ffb-b904-bc644da58aa7, amount=0.000119
2025-11-11 18:49:10 [http-nio-8080-exec-2] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=119, amount=0.000119
2025-11-11 18:49:10 [http-nio-8080-exec-2] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=119
2025-11-11 18:49:10 [http-nio-8080-exec-2] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 9395ms
2025-11-11 18:49:10 [http-nio-8080-exec-2] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 9395ms - 超过阈值: 3000ms
2025-11-11 18:49:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 18:49:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 18:49:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 18:49:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 18:49:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.097099(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.902901(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.138401(BigDecimal), 342(Long), 1258(Integer)
2025-11-11 18:49:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 18:49:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 18:49:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 18:49:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 18:49:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=c5e675f2-f81d-4ffb-b904-bc644da58aa7 chargeUserId=342 amount=0.000119
2025-11-11 18:52:36 [http-nio-8080-exec-5] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 18:52:36 [http-nio-8080-exec-5] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 18:52:36 [http-nio-8080-exec-5] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 18:52:36 [http-nio-8080-exec-5] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 18:52:36 [http-nio-8080-exec-5] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 18:52:36 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:52:36 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 18:52:36 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 18:52:36 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:52:36 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 18:52:36 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 18:52:36 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 18:52:36 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 18:52:37 [http-nio-8080-exec-5] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:52:37 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 18:52:38 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 18:52:38 [http-nio-8080-exec-5] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 18:52:38 [http-nio-8080-exec-5] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 18:52:38 [http-nio-8080-exec-5] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 18:52:39 [http-nio-8080-exec-5] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 119 tokens
2025-11-11 18:52:39 [http-nio-8080-exec-5] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 18:52:39 [http-nio-8080-exec-5] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if this is the right one? 😈(String), en(String)
2025-11-11 18:52:39 [http-nio-8080-exec-5] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 18:52:39 [http-nio-8080-exec-5] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 18:52:39 [http-nio-8080-exec-5] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 18:52:40 [http-nio-8080-exec-5] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 18:52:40 [http-nio-8080-exec-5] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 18:52:40 [http-nio-8080-exec-5] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 18:52:40 [http-nio-8080-exec-5] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 18:52:40 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:52:40 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 18:52:40 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 18:52:40 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:52:40 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 18:52:41 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 18:52:41 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:52:41 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 18:52:41 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 18:52:41 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:52:41 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 18:52:41 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 18:52:42 [http-nio-8080-exec-5] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=4c57fe62-8d63-4d0a-b9a9-e1e43a1e8bac, amount=0.000119
2025-11-11 18:52:42 [http-nio-8080-exec-5] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=119, amount=0.000119
2025-11-11 18:52:42 [http-nio-8080-exec-5] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=119
2025-11-11 18:52:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 18:52:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 18:52:42 [http-nio-8080-exec-5] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 4942ms
2025-11-11 18:52:42 [http-nio-8080-exec-5] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 4942ms - 超过阈值: 3000ms
2025-11-11 18:52:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 18:52:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 18:52:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.096980(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.903020(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.138520(BigDecimal), 342(Long), 1259(Integer)
2025-11-11 18:52:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 18:52:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 18:52:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 18:52:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 18:52:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=4c57fe62-8d63-4d0a-b9a9-e1e43a1e8bac chargeUserId=342 amount=0.000119
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 18:53:23 [http-nio-8080-exec-6] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 18:53:23 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 18:53:24 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 18:53:24 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:53:24 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 18:53:24 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 18:53:24 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:53:24 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 18:53:24 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 18:53:24 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:53:24 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 18:53:24 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 18:53:24 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:53:24 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 18:53:25 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 18:53:25 [http-nio-8080-exec-6] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 18:53:25 [http-nio-8080-exec-6] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 18:53:25 [http-nio-8080-exec-6] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 18:53:26 [http-nio-8080-exec-6] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 117 tokens
2025-11-11 18:53:26 [http-nio-8080-exec-6] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 18:53:26 [http-nio-8080-exec-6] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if it's this interface 😈(String), en(String)
2025-11-11 18:53:26 [http-nio-8080-exec-6] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 18:53:26 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 18:53:26 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 18:53:27 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 18:53:27 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 18:53:27 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 18:53:27 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 18:53:27 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:53:27 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 18:53:27 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 18:53:27 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:53:27 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 18:53:27 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 18:53:27 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:53:27 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 18:53:27 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 18:53:27 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:53:27 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 18:53:27 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 18:53:28 [http-nio-8080-exec-6] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=02474bd2-a5d1-42fe-a7b0-4655b9701a02, amount=0.000117
2025-11-11 18:53:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-2
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-2
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 18:53:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Instantiated a transactional producer.
2025-11-11 18:53:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 18:53:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 18:53:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762858408274
2025-11-11 18:53:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 18:53:28 [http-nio-8080-exec-6] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=117, amount=0.000117
2025-11-11 18:53:28 [http-nio-8080-exec-6] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=117
2025-11-11 18:53:28 [http-nio-8080-exec-6] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 4378ms
2025-11-11 18:53:28 [http-nio-8080-exec-6] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 4378ms - 超过阈值: 3000ms
2025-11-11 18:53:28 [kafka-producer-network-thread | producer-deepreach-translate-tx-2] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 18:53:28 [kafka-producer-network-thread | producer-deepreach-translate-tx-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 18:53:29 [kafka-producer-network-thread | producer-deepreach-translate-tx-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] ProducerId set to 2 with epoch 0
2025-11-11 18:53:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 18:53:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 18:53:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 18:53:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 18:53:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.096863(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.903137(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.138637(BigDecimal), 342(Long), 1260(Integer)
2025-11-11 18:53:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 18:53:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 18:53:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 18:53:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 18:53:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=02474bd2-a5d1-42fe-a7b0-4655b9701a02 chargeUserId=342 amount=0.000117
2025-11-11 18:57:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Node -1 disconnected.
2025-11-11 18:57:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Node -1 disconnected.
2025-11-11 18:57:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Node -1 disconnected.
2025-11-11 18:58:01 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.apache.kafka.clients.NetworkClient - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Node -1 disconnected.
2025-11-11 18:58:07 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.apache.kafka.clients.NetworkClient - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Node -1 disconnected.
2025-11-11 18:58:36 [http-nio-8080-exec-9] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 18:58:36 [http-nio-8080-exec-9] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 18:58:36 [http-nio-8080-exec-9] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 18:58:36 [http-nio-8080-exec-9] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 18:58:36 [http-nio-8080-exec-9] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 18:58:37 [http-nio-8080-exec-9] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:58:37 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 18:58:38 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 18:58:38 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:58:38 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 18:58:38 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 18:58:38 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:58:38 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 18:58:38 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 18:58:38 [http-nio-8080-exec-9] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 18:58:38 [http-nio-8080-exec-9] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 18:58:38 [http-nio-8080-exec-9] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 18:58:40 [http-nio-8080-exec-9] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 119 tokens
2025-11-11 18:58:40 [http-nio-8080-exec-9] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 18:58:40 [http-nio-8080-exec-9] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if this is the right one? 😈(String), en(String)
2025-11-11 18:58:40 [http-nio-8080-exec-9] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 18:58:40 [http-nio-8080-exec-9] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 18:58:40 [http-nio-8080-exec-9] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 18:58:40 [http-nio-8080-exec-9] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 18:58:40 [http-nio-8080-exec-9] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 18:58:40 [http-nio-8080-exec-9] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 18:58:40 [http-nio-8080-exec-9] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 18:58:40 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:58:40 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 18:58:40 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 18:58:40 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:58:40 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 18:58:40 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 18:58:40 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 18:58:40 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 18:58:41 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 18:58:41 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 18:58:41 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 18:58:41 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 18:58:41 [http-nio-8080-exec-9] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=05945877-265f-49dc-8b4b-b89364052e21, amount=0.000119
2025-11-11 18:58:42 [http-nio-8080-exec-9] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=119, amount=0.000119
2025-11-11 18:58:42 [http-nio-8080-exec-9] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=119
2025-11-11 18:58:42 [http-nio-8080-exec-9] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 4499ms
2025-11-11 18:58:42 [http-nio-8080-exec-9] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 4499ms - 超过阈值: 3000ms
2025-11-11 18:58:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 18:58:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 18:58:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 18:58:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 18:58:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.096744(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.903256(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.138756(BigDecimal), 342(Long), 1261(Integer)
2025-11-11 18:58:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 18:58:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 18:58:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 18:58:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 18:58:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=05945877-265f-49dc-8b4b-b89364052e21 chargeUserId=342 amount=0.000119
2025-11-11 19:02:43 [kafka-producer-network-thread | producer-deepreach-translate-tx-2] INFO  o.apache.kafka.clients.NetworkClient - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Node -1 disconnected.
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Revoke previously assigned partitions translation-charge-1
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Revoke previously assigned partitions translation-charge-0
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Revoke previously assigned partitions translation-charge-2
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions revoked: [translation-charge-0]
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions revoked: [translation-charge-2]
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions revoked: [translation-charge-1]
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Member consumer-deepreach-translation-1-5292755f-29b0-49ef-8e36-5fc0cd8d5917 sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Member consumer-deepreach-translation-2-2984f68a-03b6-4d81-8354-0f5c87e106a2 sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Member consumer-deepreach-translation-3-822fc3b2-5edb-456b-ab95-3197a0cb3598 sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-2 unregistered
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: Consumer stopped
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-3 unregistered
2025-11-11 19:03:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: Consumer stopped
2025-11-11 19:03:06 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:03:06 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:03:06 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:03:06 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-1 unregistered
2025-11-11 19:03:06 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: Consumer stopped
2025-11-11 19:03:06 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:03:06 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:03:06 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:03:06 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:03:06 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-0 unregistered
2025-11-11 19:03:06 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:03:06 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:03:06 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:03:06 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:03:06 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-1 unregistered
2025-11-11 19:03:06 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:03:06 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:03:06 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:03:06 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:03:06 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-2 unregistered
2025-11-11 19:03:06 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-11-11 19:03:06 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-11-11 19:03:07 [main] INFO  c.deepreach.web.DeepReachApplication - Starting DeepReachApplication using Java 17.0.12 with PID 48589 (/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/deepreach-web/target/classes started by gak1 in /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild)
2025-11-11 19:03:07 [main] DEBUG c.deepreach.web.DeepReachApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-11 19:03:07 [main] INFO  c.deepreach.web.DeepReachApplication - The following 1 profile is active: "dev"
2025-11-11 19:03:08 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-11 19:03:08 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-11 19:03:08 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2025-11-11 19:03:08 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-11 19:03:08 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-11 19:03:08 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-11 19:03:08 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-11 19:03:08 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1078 ms
2025-11-11 19:03:09 [main] DEBUG c.d.c.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-11-11 19:03:09 [main] ERROR i.n.r.d.DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
2025-11-11 19:03:09 [main] INFO  c.d.w.s.impl.FileStorageServiceImpl - 文件上传目录: /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 19:03:10 [main] INFO  c.d.message.worker.SmsSendWorker - SmsSendWorker started
2025-11-11 19:03:10 [main] INFO  c.deepreach.web.config.WebMvcConfig - 静态资源映射配置：/uploads/** -> file:/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 19:03:10 [main] INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@761a0bbd, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7a6e0f3c, org.springframework.security.web.context.SecurityContextHolderFilter@7bc4ac3e, org.springframework.security.web.header.HeaderWriterFilter@46c19350, org.springframework.web.filter.CorsFilter@5184da2b, org.springframework.security.web.authentication.logout.LogoutFilter@7603cfc2, com.deepreach.common.security.JwtAuthenticationFilter@5c41b8d8, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@16e5c19f, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@59263f7b, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@6fa2d0b2, org.springframework.security.web.session.SessionManagementFilter@7f3a92fd, org.springframework.security.web.access.ExceptionTranslationFilter@5cb6b81b, org.springframework.security.web.access.intercept.AuthorizationFilter@2b55ea4d]
2025-11-11 19:03:10 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-11 19:03:10 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:03:10 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:03:10 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:03:10 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:03:10 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762858990798
2025-11-11 19:03:10 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Subscribed to topic(s): translation-charge
2025-11-11 19:03:10 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:03:10 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:03:10 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:03:10 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:03:10 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762858990803
2025-11-11 19:03:10 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Subscribed to topic(s): translation-charge
2025-11-11 19:03:10 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:03:10 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:03:10 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:03:10 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:03:10 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762858990805
2025-11-11 19:03:10 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Subscribed to topic(s): translation-charge
2025-11-11 19:03:10 [main] INFO  c.deepreach.web.DeepReachApplication - Started DeepReachApplication in 3.381 seconds (process running for 3.685)
2025-11-11 19:03:10 [main] INFO  c.d.web.config.DataSourceHealthCheck - 开始检查数据源配置...
2025-11-11 19:03:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:03:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:03:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:03:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:03:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:03:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:03:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:03:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:03:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:03:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-1-ec82948e-5119-4d2f-83b4-14683a8a8293
2025-11-11 19:03:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:03:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:03:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-3-3f85c4b3-2f97-4aee-a0a6-1e9711b35041
2025-11-11 19:03:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:03:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:03:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-2-ce645abc-f1cf-41d0-9316-fc818ea10c91
2025-11-11 19:03:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:03:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:03:15 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Successfully joined group with generation Generation{generationId=7, memberId='consumer-deepreach-translation-3-3f85c4b3-2f97-4aee-a0a6-1e9711b35041', protocol='range'}
2025-11-11 19:03:15 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Successfully joined group with generation Generation{generationId=7, memberId='consumer-deepreach-translation-1-ec82948e-5119-4d2f-83b4-14683a8a8293', protocol='range'}
2025-11-11 19:03:15 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Finished assignment for group at generation 7: {consumer-deepreach-translation-2-ce645abc-f1cf-41d0-9316-fc818ea10c91=Assignment(partitions=[translation-charge-1]), consumer-deepreach-translation-1-ec82948e-5119-4d2f-83b4-14683a8a8293=Assignment(partitions=[translation-charge-0]), consumer-deepreach-translation-3-3f85c4b3-2f97-4aee-a0a6-1e9711b35041=Assignment(partitions=[translation-charge-2])}
2025-11-11 19:03:15 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Successfully joined group with generation Generation{generationId=7, memberId='consumer-deepreach-translation-2-ce645abc-f1cf-41d0-9316-fc818ea10c91', protocol='range'}
2025-11-11 19:03:15 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Successfully synced group in generation Generation{generationId=7, memberId='consumer-deepreach-translation-1-ec82948e-5119-4d2f-83b4-14683a8a8293', protocol='range'}
2025-11-11 19:03:15 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Notifying assignor about the new Assignment(partitions=[translation-charge-0])
2025-11-11 19:03:15 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Adding newly assigned partitions: translation-charge-0
2025-11-11 19:03:15 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Successfully synced group in generation Generation{generationId=7, memberId='consumer-deepreach-translation-2-ce645abc-f1cf-41d0-9316-fc818ea10c91', protocol='range'}
2025-11-11 19:03:15 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Notifying assignor about the new Assignment(partitions=[translation-charge-1])
2025-11-11 19:03:15 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Adding newly assigned partitions: translation-charge-1
2025-11-11 19:03:16 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Setting offset for partition translation-charge-1 to the committed offset FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:03:16 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions assigned: [translation-charge-1]
2025-11-11 19:03:16 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Successfully synced group in generation Generation{generationId=7, memberId='consumer-deepreach-translation-3-3f85c4b3-2f97-4aee-a0a6-1e9711b35041', protocol='range'}
2025-11-11 19:03:16 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Notifying assignor about the new Assignment(partitions=[translation-charge-2])
2025-11-11 19:03:16 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Adding newly assigned partitions: translation-charge-2
2025-11-11 19:03:16 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Setting offset for partition translation-charge-0 to the committed offset FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:03:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions assigned: [translation-charge-0]
2025-11-11 19:03:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Setting offset for partition translation-charge-2 to the committed offset FetchPosition{offset=5, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:03:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions assigned: [translation-charge-2]
2025-11-11 19:03:21 [main] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-11-11 19:03:22 [main] INFO  c.d.web.config.DataSourceHealthCheck - 主数据源连接成功: PRIMARY_OK
2025-11-11 19:03:24 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据源连接成功: CLOUD_COMPUTER_OK
2025-11-11 19:03:26 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据库中admin用户记录数: 0
2025-11-11 19:03:26 [main] INFO  c.d.web.config.DataSourceHealthCheck - 数据源检查完成
2025-11-11 19:03:26 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 开始构建用户层级树缓存...
2025-11-11 19:03:26 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==>  Preparing: SELECT u.user_id AS userId, u.parent_user_id AS parentUserId FROM sys_user u WHERE u.status = '0'
2025-11-11 19:03:26 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==> Parameters: 
2025-11-11 19:03:26 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - <==      Total: 72
2025-11-11 19:03:26 [main] INFO  c.d.c.c.s.impl.SysUserServiceImpl - 用户层级树缓存刷新成功：记录总数=72, 根节点数量=1
2025-11-11 19:03:26 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 用户层级树缓存构建完成
2025-11-11 19:03:29 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-11 19:03:29 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-11 19:03:29 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-11-11 19:03:29 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 19:03:29 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 19:03:29 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 19:03:29 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 19:03:29 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 19:03:29 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:03:29 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 19:03:29 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 19:03:29 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:03:29 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 19:03:30 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 19:03:30 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 19:03:30 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 19:03:30 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 19:03:30 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 19:03:30 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 19:03:30 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 19:03:30 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 19:03:30 [http-nio-8080-exec-2] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 19:03:30 [http-nio-8080-exec-2] WARN  o.s.w.s.h.HandlerMappingIntrospector - Cache miss for REQUEST dispatch to '/api/translate' (previous null). Performing MatchableHandlerMapping lookup. This is logged once only at WARN level, and every time at TRACE.
2025-11-11 19:03:30 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 19:03:30 [http-nio-8080-exec-2] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 19:03:30 [http-nio-8080-exec-2] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-0
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-0
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:03:30 [http-nio-8080-exec-2] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Instantiated a transactional producer.
2025-11-11 19:03:30 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:03:30 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:03:30 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762859010349
2025-11-11 19:03:30 [http-nio-8080-exec-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:03:30 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:03:30 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:03:31 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] ProducerId set to 0 with epoch 2
2025-11-11 19:03:31 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:03:31 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:03:32 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:03:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:03:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 19:03:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:03:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:03:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 19:03:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:03:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:03:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 19:03:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:03:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:03:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 19:03:33 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:03:33 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:03:33 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:03:33 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:03:34 [http-nio-8080-exec-2] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 119 tokens
2025-11-11 19:03:34 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 19:03:34 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if this is the correct one? 😈(String), en(String)
2025-11-11 19:03:35 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 19:03:35 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:03:35 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:03:35 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:03:35 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:03:35 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:03:35 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:03:35 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:03:35 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 19:03:35 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:03:35 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:03:35 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 19:03:35 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:03:35 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:03:35 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 19:03:35 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:03:35 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:03:35 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 19:03:36 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:03:36 [http-nio-8080-exec-2] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-1
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-1
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:03:36 [http-nio-8080-exec-2] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Instantiated a transactional producer.
2025-11-11 19:03:36 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:03:36 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:03:36 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762859016071
2025-11-11 19:03:36 [http-nio-8080-exec-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:03:36 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:03:36 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:03:37 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] ProducerId set to 1 with epoch 2
2025-11-11 19:03:38 [http-nio-8080-exec-2] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=b3c76be8-a2ad-4ef9-998e-d668459245e0, amount=0.000119
2025-11-11 19:03:38 [http-nio-8080-exec-2] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=119, amount=0.000119
2025-11-11 19:03:38 [http-nio-8080-exec-2] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=119
2025-11-11 19:03:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:03:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:03:38 [http-nio-8080-exec-2] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 7925ms
2025-11-11 19:03:38 [http-nio-8080-exec-2] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 7925ms - 超过阈值: 3000ms
2025-11-11 19:03:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:03:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 19:03:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.096625(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.903375(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.138875(BigDecimal), 342(Long), 1262(Integer)
2025-11-11 19:03:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 19:03:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:03:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:03:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:03:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=b3c76be8-a2ad-4ef9-998e-d668459245e0 chargeUserId=342 amount=0.000119
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Revoke previously assigned partitions translation-charge-0
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Revoke previously assigned partitions translation-charge-2
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Revoke previously assigned partitions translation-charge-1
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions revoked: [translation-charge-0]
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions revoked: [translation-charge-1]
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions revoked: [translation-charge-2]
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Member consumer-deepreach-translation-2-ce645abc-f1cf-41d0-9316-fc818ea10c91 sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Member consumer-deepreach-translation-3-3f85c4b3-2f97-4aee-a0a6-1e9711b35041 sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Member consumer-deepreach-translation-1-ec82948e-5119-4d2f-83b4-14683a8a8293 sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:08:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:08:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:08:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:08:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:08:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-1 unregistered
2025-11-11 19:08:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: Consumer stopped
2025-11-11 19:08:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:08:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:08:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:08:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-2 unregistered
2025-11-11 19:08:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: Consumer stopped
2025-11-11 19:08:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:08:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:08:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:08:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-3 unregistered
2025-11-11 19:08:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: Consumer stopped
2025-11-11 19:08:42 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:08:42 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:08:42 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:08:42 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:08:42 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-0 unregistered
2025-11-11 19:08:42 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:08:42 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:08:42 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:08:42 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:08:42 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-1 unregistered
2025-11-11 19:08:42 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-11-11 19:08:42 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-11-11 19:08:44 [main] INFO  c.deepreach.web.DeepReachApplication - Starting DeepReachApplication using Java 17.0.12 with PID 48821 (/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/deepreach-web/target/classes started by gak1 in /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild)
2025-11-11 19:08:44 [main] DEBUG c.deepreach.web.DeepReachApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-11 19:08:44 [main] INFO  c.deepreach.web.DeepReachApplication - The following 1 profile is active: "dev"
2025-11-11 19:08:44 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-11 19:08:44 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-11 19:08:45 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2025-11-11 19:08:45 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-11 19:08:45 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-11 19:08:45 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-11 19:08:45 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-11 19:08:45 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 803 ms
2025-11-11 19:08:45 [main] DEBUG c.d.c.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-11-11 19:08:45 [main] ERROR i.n.r.d.DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
2025-11-11 19:08:45 [main] INFO  c.d.w.s.impl.FileStorageServiceImpl - 文件上传目录: /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 19:08:46 [main] INFO  c.d.message.worker.SmsSendWorker - SmsSendWorker started
2025-11-11 19:08:46 [main] INFO  c.deepreach.web.config.WebMvcConfig - 静态资源映射配置：/uploads/** -> file:/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 19:08:46 [main] INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@57df93c1, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@72998021, org.springframework.security.web.context.SecurityContextHolderFilter@4e111e08, org.springframework.security.web.header.HeaderWriterFilter@5cb6b81b, org.springframework.web.filter.CorsFilter@761a0bbd, org.springframework.security.web.authentication.logout.LogoutFilter@3a5b1af7, com.deepreach.common.security.JwtAuthenticationFilter@3ccfac29, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@7bc4ac3e, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@504274c1, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@7a6e0f3c, org.springframework.security.web.session.SessionManagementFilter@18ad085a, org.springframework.security.web.access.ExceptionTranslationFilter@551725e4, org.springframework.security.web.access.intercept.AuthorizationFilter@7e1953f7]
2025-11-11 19:08:46 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-11 19:08:46 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:08:46 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:08:46 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:08:46 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:08:46 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762859326875
2025-11-11 19:08:46 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Subscribed to topic(s): translation-charge
2025-11-11 19:08:46 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:08:46 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:08:46 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:08:46 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:08:46 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762859326880
2025-11-11 19:08:46 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Subscribed to topic(s): translation-charge
2025-11-11 19:08:46 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:08:46 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:08:46 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:08:46 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:08:46 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762859326882
2025-11-11 19:08:46 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Subscribed to topic(s): translation-charge
2025-11-11 19:08:46 [main] INFO  c.deepreach.web.DeepReachApplication - Started DeepReachApplication in 2.51 seconds (process running for 2.804)
2025-11-11 19:08:46 [main] INFO  c.d.web.config.DataSourceHealthCheck - 开始检查数据源配置...
2025-11-11 19:08:47 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:08:47 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:08:47 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:08:47 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:08:47 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:08:47 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:08:47 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:08:47 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:08:47 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:08:47 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-2-cb4b820c-55ac-4559-bf22-7d4b10e7509c
2025-11-11 19:08:47 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:08:47 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:08:47 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-1-7b551baa-7874-4d80-816e-95d483abeb36
2025-11-11 19:08:47 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:08:47 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:08:48 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-3-8c938ff6-5a45-4069-95fb-5fee17069b33
2025-11-11 19:08:48 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:08:48 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:08:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Successfully joined group with generation Generation{generationId=9, memberId='consumer-deepreach-translation-2-cb4b820c-55ac-4559-bf22-7d4b10e7509c', protocol='range'}
2025-11-11 19:08:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Successfully joined group with generation Generation{generationId=9, memberId='consumer-deepreach-translation-3-8c938ff6-5a45-4069-95fb-5fee17069b33', protocol='range'}
2025-11-11 19:08:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Successfully joined group with generation Generation{generationId=9, memberId='consumer-deepreach-translation-1-7b551baa-7874-4d80-816e-95d483abeb36', protocol='range'}
2025-11-11 19:08:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Finished assignment for group at generation 9: {consumer-deepreach-translation-2-cb4b820c-55ac-4559-bf22-7d4b10e7509c=Assignment(partitions=[translation-charge-1]), consumer-deepreach-translation-1-7b551baa-7874-4d80-816e-95d483abeb36=Assignment(partitions=[translation-charge-0]), consumer-deepreach-translation-3-8c938ff6-5a45-4069-95fb-5fee17069b33=Assignment(partitions=[translation-charge-2])}
2025-11-11 19:08:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Successfully synced group in generation Generation{generationId=9, memberId='consumer-deepreach-translation-3-8c938ff6-5a45-4069-95fb-5fee17069b33', protocol='range'}
2025-11-11 19:08:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Notifying assignor about the new Assignment(partitions=[translation-charge-2])
2025-11-11 19:08:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Successfully synced group in generation Generation{generationId=9, memberId='consumer-deepreach-translation-2-cb4b820c-55ac-4559-bf22-7d4b10e7509c', protocol='range'}
2025-11-11 19:08:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Notifying assignor about the new Assignment(partitions=[translation-charge-1])
2025-11-11 19:08:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Adding newly assigned partitions: translation-charge-2
2025-11-11 19:08:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Adding newly assigned partitions: translation-charge-1
2025-11-11 19:08:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Setting offset for partition translation-charge-1 to the committed offset FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:08:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Setting offset for partition translation-charge-2 to the committed offset FetchPosition{offset=7, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:08:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Successfully synced group in generation Generation{generationId=9, memberId='consumer-deepreach-translation-1-7b551baa-7874-4d80-816e-95d483abeb36', protocol='range'}
2025-11-11 19:08:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Notifying assignor about the new Assignment(partitions=[translation-charge-0])
2025-11-11 19:08:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Adding newly assigned partitions: translation-charge-0
2025-11-11 19:08:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions assigned: [translation-charge-2]
2025-11-11 19:08:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions assigned: [translation-charge-1]
2025-11-11 19:08:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Setting offset for partition translation-charge-0 to the committed offset FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:08:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions assigned: [translation-charge-0]
2025-11-11 19:08:59 [main] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-11-11 19:08:59 [main] INFO  c.d.web.config.DataSourceHealthCheck - 主数据源连接成功: PRIMARY_OK
2025-11-11 19:09:00 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据源连接成功: CLOUD_COMPUTER_OK
2025-11-11 19:09:01 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据库中admin用户记录数: 0
2025-11-11 19:09:01 [main] INFO  c.d.web.config.DataSourceHealthCheck - 数据源检查完成
2025-11-11 19:09:01 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 开始构建用户层级树缓存...
2025-11-11 19:09:01 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==>  Preparing: SELECT u.user_id AS userId, u.parent_user_id AS parentUserId FROM sys_user u WHERE u.status = '0'
2025-11-11 19:09:01 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==> Parameters: 
2025-11-11 19:09:02 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - <==      Total: 72
2025-11-11 19:09:02 [main] INFO  c.d.c.c.s.impl.SysUserServiceImpl - 用户层级树缓存刷新成功：记录总数=72, 根节点数量=1
2025-11-11 19:09:02 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 用户层级树缓存构建完成
2025-11-11 19:09:09 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-11 19:09:09 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-11 19:09:09 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 4 ms
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 19:09:09 [http-nio-8080-exec-2] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 19:09:09 [http-nio-8080-exec-2] WARN  o.s.w.s.h.HandlerMappingIntrospector - Cache miss for REQUEST dispatch to '/api/translate' (previous null). Performing MatchableHandlerMapping lookup. This is logged once only at WARN level, and every time at TRACE.
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 19:09:09 [http-nio-8080-exec-2] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 19:09:09 [http-nio-8080-exec-2] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-0
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-0
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:09:09 [http-nio-8080-exec-2] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Instantiated a transactional producer.
2025-11-11 19:09:09 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:09:09 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:09:09 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762859349879
2025-11-11 19:09:09 [http-nio-8080-exec-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:09:10 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:09:10 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:09:10 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] ProducerId set to 0 with epoch 3
2025-11-11 19:09:10 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:09:10 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:09:11 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:09:11 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:09:11 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 19:09:11 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:09:11 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:09:11 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 19:09:11 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:09:11 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:09:11 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 19:09:12 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:09:12 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:09:12 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 19:09:12 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:09:12 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:09:12 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:09:12 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:09:14 [http-nio-8080-exec-2] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 118 tokens
2025-11-11 19:09:14 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 19:09:14 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if this is the right one 😈(String), en(String)
2025-11-11 19:09:14 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 19:09:14 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:09:14 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:09:14 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:09:14 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:09:14 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:09:14 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:09:14 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:09:14 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 19:09:15 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:09:15 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:09:15 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 19:09:15 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:09:15 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:09:15 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 19:09:15 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:09:15 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:09:15 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 19:09:15 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:09:15 [http-nio-8080-exec-2] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-1
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-1
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:09:15 [http-nio-8080-exec-2] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Instantiated a transactional producer.
2025-11-11 19:09:15 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:09:15 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:09:15 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762859355552
2025-11-11 19:09:15 [http-nio-8080-exec-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:09:16 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:09:16 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:09:16 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] ProducerId set to 1 with epoch 3
2025-11-11 19:09:17 [http-nio-8080-exec-2] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=abaadb47-9379-4c54-8d38-b2738c0ea2fb, amount=0.000118
2025-11-11 19:09:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-2
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-2
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:09:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Instantiated a transactional producer.
2025-11-11 19:09:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:09:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:09:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762859357517
2025-11-11 19:09:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:09:17 [http-nio-8080-exec-2] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=118, amount=0.000118
2025-11-11 19:09:17 [http-nio-8080-exec-2] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=118
2025-11-11 19:09:17 [http-nio-8080-exec-2] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 7853ms
2025-11-11 19:09:17 [http-nio-8080-exec-2] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 7853ms - 超过阈值: 3000ms
2025-11-11 19:09:18 [kafka-producer-network-thread | producer-deepreach-translate-tx-2] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:09:18 [kafka-producer-network-thread | producer-deepreach-translate-tx-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:09:18 [kafka-producer-network-thread | producer-deepreach-translate-tx-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] ProducerId set to 2 with epoch 1
2025-11-11 19:09:18 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:09:18 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:09:19 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:09:19 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 19:09:19 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.096507(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.903493(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.138993(BigDecimal), 342(Long), 1263(Integer)
2025-11-11 19:09:19 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 19:09:19 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:09:19 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:09:19 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:09:19 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=abaadb47-9379-4c54-8d38-b2738c0ea2fb chargeUserId=342 amount=0.000118
2025-11-11 19:11:29 [http-nio-8080-exec-5] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 19:11:29 [http-nio-8080-exec-5] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 19:11:29 [http-nio-8080-exec-5] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 19:11:29 [http-nio-8080-exec-5] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 19:11:29 [http-nio-8080-exec-5] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 19:11:29 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:11:29 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 19:11:29 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 19:11:29 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:11:29 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 19:11:30 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 19:11:30 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 19:11:30 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 19:11:30 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 19:11:30 [http-nio-8080-exec-5] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 19:11:30 [http-nio-8080-exec-5] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 19:11:30 [http-nio-8080-exec-5] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 19:11:30 [http-nio-8080-exec-5] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 19:11:30 [http-nio-8080-exec-5] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 19:11:30 [http-nio-8080-exec-5] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 19:11:30 [http-nio-8080-exec-5] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 19:11:30 [http-nio-8080-exec-5] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:11:30 [http-nio-8080-exec-5] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:11:31 [http-nio-8080-exec-5] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:11:31 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:11:31 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 19:11:31 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:11:31 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:11:31 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 19:11:31 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:11:31 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:11:31 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 19:11:31 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:11:31 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:11:31 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 19:11:31 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:11:31 [http-nio-8080-exec-5] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:11:31 [http-nio-8080-exec-5] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:11:32 [http-nio-8080-exec-5] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:11:34 [http-nio-8080-exec-5] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 119 tokens
2025-11-11 19:11:34 [http-nio-8080-exec-5] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 19:11:34 [http-nio-8080-exec-5] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if this is the right one? 😈(String), en(String)
2025-11-11 19:11:34 [http-nio-8080-exec-5] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 19:11:34 [http-nio-8080-exec-5] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:11:34 [http-nio-8080-exec-5] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:11:34 [http-nio-8080-exec-5] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:11:34 [http-nio-8080-exec-5] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:11:34 [http-nio-8080-exec-5] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:11:34 [http-nio-8080-exec-5] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:11:34 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:11:34 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 19:11:34 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:11:34 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:11:34 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 19:11:36 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:11:36 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:11:36 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 19:11:37 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:11:37 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:11:37 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 19:11:37 [http-nio-8080-exec-5] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:11:37 [http-nio-8080-exec-5] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=5539ccb3-b8fb-4fd8-a990-4fe3faaf72a6, amount=0.000119
2025-11-11 19:11:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:11:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:11:37 [http-nio-8080-exec-5] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=119, amount=0.000119
2025-11-11 19:11:37 [http-nio-8080-exec-5] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=119
2025-11-11 19:11:37 [http-nio-8080-exec-5] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 6992ms
2025-11-11 19:11:37 [http-nio-8080-exec-5] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 6992ms - 超过阈值: 3000ms
2025-11-11 19:11:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:11:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 19:11:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.096388(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.903612(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.139112(BigDecimal), 342(Long), 1264(Integer)
2025-11-11 19:11:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 19:11:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:11:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:11:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:11:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=5539ccb3-b8fb-4fd8-a990-4fe3faaf72a6 chargeUserId=342 amount=0.000119
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Revoke previously assigned partitions translation-charge-1
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Revoke previously assigned partitions translation-charge-0
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Revoke previously assigned partitions translation-charge-2
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions revoked: [translation-charge-2]
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions revoked: [translation-charge-0]
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions revoked: [translation-charge-1]
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Member consumer-deepreach-translation-1-7b551baa-7874-4d80-816e-95d483abeb36 sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Member consumer-deepreach-translation-3-8c938ff6-5a45-4069-95fb-5fee17069b33 sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Member consumer-deepreach-translation-2-cb4b820c-55ac-4559-bf22-7d4b10e7509c sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-3 unregistered
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: Consumer stopped
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-2 unregistered
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: Consumer stopped
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-1 unregistered
2025-11-11 19:13:45 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: Consumer stopped
2025-11-11 19:13:46 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:13:46 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:13:46 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:13:46 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:13:46 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-0 unregistered
2025-11-11 19:13:46 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:13:46 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:13:46 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:13:46 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:13:46 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-1 unregistered
2025-11-11 19:13:46 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:13:46 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:13:46 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:13:46 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:13:46 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-2 unregistered
2025-11-11 19:13:46 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-11-11 19:13:46 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-11-11 19:14:09 [main] INFO  c.deepreach.web.DeepReachApplication - Starting DeepReachApplication using Java 17.0.12 with PID 48927 (/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/deepreach-web/target/classes started by gak1 in /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild)
2025-11-11 19:14:09 [main] DEBUG c.deepreach.web.DeepReachApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-11 19:14:09 [main] INFO  c.deepreach.web.DeepReachApplication - The following 1 profile is active: "dev"
2025-11-11 19:14:09 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-11 19:14:09 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-11 19:14:09 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-11-11 19:14:10 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-11 19:14:10 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-11 19:14:10 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-11 19:14:10 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-11 19:14:10 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1084 ms
2025-11-11 19:14:10 [main] DEBUG c.d.c.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-11-11 19:14:10 [main] ERROR i.n.r.d.DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
2025-11-11 19:14:10 [main] INFO  c.d.w.s.impl.FileStorageServiceImpl - 文件上传目录: /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 19:14:11 [main] INFO  c.d.message.worker.SmsSendWorker - SmsSendWorker started
2025-11-11 19:14:11 [main] INFO  c.deepreach.web.config.WebMvcConfig - 静态资源映射配置：/uploads/** -> file:/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 19:14:11 [main] INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@2b55ea4d, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@63ede2a0, org.springframework.security.web.context.SecurityContextHolderFilter@15ea0ca3, org.springframework.security.web.header.HeaderWriterFilter@551725e4, org.springframework.web.filter.CorsFilter@57df93c1, org.springframework.security.web.authentication.logout.LogoutFilter@15254569, com.deepreach.common.security.JwtAuthenticationFilter@c4551c6, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4e111e08, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@3e0e3048, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@72998021, org.springframework.security.web.session.SessionManagementFilter@2e488e45, org.springframework.security.web.access.ExceptionTranslationFilter@3333245e, org.springframework.security.web.access.intercept.AuthorizationFilter@5d8a1456]
2025-11-11 19:14:11 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-11 19:14:11 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:14:11 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:14:11 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:14:11 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:14:11 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762859651732
2025-11-11 19:14:11 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Subscribed to topic(s): translation-charge
2025-11-11 19:14:11 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:14:11 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:14:11 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:14:11 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:14:11 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762859651737
2025-11-11 19:14:11 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Subscribed to topic(s): translation-charge
2025-11-11 19:14:11 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:14:11 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:14:11 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:14:11 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:14:11 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762859651739
2025-11-11 19:14:11 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Subscribed to topic(s): translation-charge
2025-11-11 19:14:11 [main] INFO  c.deepreach.web.DeepReachApplication - Started DeepReachApplication in 2.84 seconds (process running for 3.162)
2025-11-11 19:14:11 [main] INFO  c.d.web.config.DataSourceHealthCheck - 开始检查数据源配置...
2025-11-11 19:14:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:14:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:14:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:14:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:14:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:14:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:14:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:14:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:14:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:14:13 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-2-72492de0-c96c-49bf-9bd9-30c682947d6e
2025-11-11 19:14:13 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:14:13 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:14:13 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-3-7312ceac-f18c-4590-94c8-bf44eae6d91d
2025-11-11 19:14:13 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:14:13 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:14:14 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-1-d5667fc3-ac2d-432d-8920-2fe95285b706
2025-11-11 19:14:14 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:14:14 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:14:19 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Successfully joined group with generation Generation{generationId=11, memberId='consumer-deepreach-translation-1-d5667fc3-ac2d-432d-8920-2fe95285b706', protocol='range'}
2025-11-11 19:14:19 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Successfully joined group with generation Generation{generationId=11, memberId='consumer-deepreach-translation-2-72492de0-c96c-49bf-9bd9-30c682947d6e', protocol='range'}
2025-11-11 19:14:19 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Successfully joined group with generation Generation{generationId=11, memberId='consumer-deepreach-translation-3-7312ceac-f18c-4590-94c8-bf44eae6d91d', protocol='range'}
2025-11-11 19:14:19 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Finished assignment for group at generation 11: {consumer-deepreach-translation-1-d5667fc3-ac2d-432d-8920-2fe95285b706=Assignment(partitions=[translation-charge-0]), consumer-deepreach-translation-2-72492de0-c96c-49bf-9bd9-30c682947d6e=Assignment(partitions=[translation-charge-1]), consumer-deepreach-translation-3-7312ceac-f18c-4590-94c8-bf44eae6d91d=Assignment(partitions=[translation-charge-2])}
2025-11-11 19:14:23 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Successfully synced group in generation Generation{generationId=11, memberId='consumer-deepreach-translation-3-7312ceac-f18c-4590-94c8-bf44eae6d91d', protocol='range'}
2025-11-11 19:14:23 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Successfully synced group in generation Generation{generationId=11, memberId='consumer-deepreach-translation-2-72492de0-c96c-49bf-9bd9-30c682947d6e', protocol='range'}
2025-11-11 19:14:23 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Notifying assignor about the new Assignment(partitions=[translation-charge-1])
2025-11-11 19:14:23 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Notifying assignor about the new Assignment(partitions=[translation-charge-2])
2025-11-11 19:14:23 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Adding newly assigned partitions: translation-charge-2
2025-11-11 19:14:23 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Adding newly assigned partitions: translation-charge-1
2025-11-11 19:14:23 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Successfully synced group in generation Generation{generationId=11, memberId='consumer-deepreach-translation-1-d5667fc3-ac2d-432d-8920-2fe95285b706', protocol='range'}
2025-11-11 19:14:23 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Notifying assignor about the new Assignment(partitions=[translation-charge-0])
2025-11-11 19:14:23 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Adding newly assigned partitions: translation-charge-0
2025-11-11 19:14:24 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Setting offset for partition translation-charge-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:14:24 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Setting offset for partition translation-charge-2 to the committed offset FetchPosition{offset=10, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:14:24 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Setting offset for partition translation-charge-1 to the committed offset FetchPosition{offset=2, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:14:24 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions assigned: [translation-charge-0]
2025-11-11 19:14:24 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions assigned: [translation-charge-1]
2025-11-11 19:14:24 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions assigned: [translation-charge-2]
2025-11-11 19:14:35 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-11 19:14:35 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-11 19:14:35 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2025-11-11 19:14:35 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 19:14:35 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 19:14:35 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 19:14:35 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 19:14:35 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 19:14:47 [main] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-11-11 19:14:47 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:14:47 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 19:14:48 [main] INFO  c.d.web.config.DataSourceHealthCheck - 主数据源连接成功: PRIMARY_OK
2025-11-11 19:14:48 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 19:14:48 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:14:48 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 19:14:48 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 19:14:48 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 19:14:48 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 19:14:49 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 19:14:49 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 19:14:49 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 19:14:49 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 19:14:49 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 19:14:49 [http-nio-8080-exec-2] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 19:14:49 [http-nio-8080-exec-2] WARN  o.s.w.s.h.HandlerMappingIntrospector - Cache miss for REQUEST dispatch to '/api/translate' (previous null). Performing MatchableHandlerMapping lookup. This is logged once only at WARN level, and every time at TRACE.
2025-11-11 19:14:49 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 19:14:49 [http-nio-8080-exec-2] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 19:14:49 [http-nio-8080-exec-2] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-0
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-0
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:14:49 [http-nio-8080-exec-2] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Instantiated a transactional producer.
2025-11-11 19:14:49 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:14:49 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:14:49 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762859689179
2025-11-11 19:14:49 [http-nio-8080-exec-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:14:49 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据源连接成功: CLOUD_COMPUTER_OK
2025-11-11 19:14:49 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:14:49 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:14:50 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] ProducerId set to 0 with epoch 4
2025-11-11 19:14:50 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:14:50 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:14:50 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:14:50 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:14:50 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 19:14:50 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据库中admin用户记录数: 0
2025-11-11 19:14:50 [main] INFO  c.d.web.config.DataSourceHealthCheck - 数据源检查完成
2025-11-11 19:14:50 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 开始构建用户层级树缓存...
2025-11-11 19:14:50 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==>  Preparing: SELECT u.user_id AS userId, u.parent_user_id AS parentUserId FROM sys_user u WHERE u.status = '0'
2025-11-11 19:14:50 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==> Parameters: 
2025-11-11 19:14:50 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:14:50 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:14:50 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 19:14:50 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - <==      Total: 72
2025-11-11 19:14:50 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:14:50 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:14:50 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 19:14:50 [main] INFO  c.d.c.c.s.impl.SysUserServiceImpl - 用户层级树缓存刷新成功：记录总数=72, 根节点数量=1
2025-11-11 19:14:50 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 用户层级树缓存构建完成
2025-11-11 19:14:50 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:14:50 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:14:50 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 19:14:51 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:14:51 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:14:51 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:14:51 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:14:52 [http-nio-8080-exec-2] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 119 tokens
2025-11-11 19:14:52 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 19:14:52 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if this is the correct one? 😈(String), en(String)
2025-11-11 19:14:53 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 19:14:53 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:14:53 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:14:53 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:14:53 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:14:53 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:14:53 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:14:53 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:14:53 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 19:14:54 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:14:54 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:14:54 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 19:14:54 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:14:54 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:14:54 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 19:14:54 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:14:54 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:14:54 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 19:14:54 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:14:54 [http-nio-8080-exec-2] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-1
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-1
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:14:54 [http-nio-8080-exec-2] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Instantiated a transactional producer.
2025-11-11 19:14:54 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:14:54 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:14:54 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762859694612
2025-11-11 19:14:54 [http-nio-8080-exec-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:14:55 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:14:55 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:14:55 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] ProducerId set to 1 with epoch 4
2025-11-11 19:14:57 [http-nio-8080-exec-2] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=19ceafc3-e080-4f57-bbb0-4b4e1053ea49, amount=0.000119
2025-11-11 19:14:57 [http-nio-8080-exec-2] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=119, amount=0.000119
2025-11-11 19:14:57 [http-nio-8080-exec-2] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=119
2025-11-11 19:14:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:14:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:14:57 [http-nio-8080-exec-2] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 8087ms
2025-11-11 19:14:57 [http-nio-8080-exec-2] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 8087ms - 超过阈值: 3000ms
2025-11-11 19:14:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:14:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 19:14:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.096269(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.903731(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.139231(BigDecimal), 342(Long), 1265(Integer)
2025-11-11 19:14:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 19:14:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:14:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:14:58 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:14:58 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=19ceafc3-e080-4f57-bbb0-4b4e1053ea49 chargeUserId=342 amount=0.000119
2025-11-11 19:23:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Node -1 disconnected.
2025-11-11 19:23:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Node -1 disconnected.
2025-11-11 19:23:13 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Node -1 disconnected.
2025-11-11 19:23:49 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.apache.kafka.clients.NetworkClient - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Node -1 disconnected.
2025-11-11 19:23:55 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.apache.kafka.clients.NetworkClient - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Node -1 disconnected.
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Revoke previously assigned partitions translation-charge-0
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Revoke previously assigned partitions translation-charge-2
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Revoke previously assigned partitions translation-charge-1
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions revoked: [translation-charge-2]
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions revoked: [translation-charge-0]
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions revoked: [translation-charge-1]
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Member consumer-deepreach-translation-1-d5667fc3-ac2d-432d-8920-2fe95285b706 sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Member consumer-deepreach-translation-3-7312ceac-f18c-4590-94c8-bf44eae6d91d sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Member consumer-deepreach-translation-2-72492de0-c96c-49bf-9bd9-30c682947d6e sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:28:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:28:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:28:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:28:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:28:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-3 unregistered
2025-11-11 19:28:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: Consumer stopped
2025-11-11 19:28:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:28:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:28:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:28:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-2 unregistered
2025-11-11 19:28:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: Consumer stopped
2025-11-11 19:28:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:28:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:28:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:28:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-1 unregistered
2025-11-11 19:28:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: Consumer stopped
2025-11-11 19:28:11 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:28:11 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:28:11 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:28:11 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:28:11 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-0 unregistered
2025-11-11 19:28:11 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:28:11 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:28:11 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:28:11 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:28:11 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-1 unregistered
2025-11-11 19:28:11 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-11-11 19:28:11 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-11-11 19:29:14 [main] INFO  c.deepreach.web.DeepReachApplication - Starting DeepReachApplication using Java 17.0.12 with PID 49372 (/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/deepreach-web/target/classes started by gak1 in /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild)
2025-11-11 19:29:14 [main] DEBUG c.deepreach.web.DeepReachApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-11 19:29:14 [main] INFO  c.deepreach.web.DeepReachApplication - The following 1 profile is active: "dev"
2025-11-11 19:29:14 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-11 19:29:14 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-11 19:29:14 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2025-11-11 19:29:15 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-11 19:29:15 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-11 19:29:15 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-11 19:29:15 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-11 19:29:15 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 858 ms
2025-11-11 19:29:15 [main] DEBUG c.d.c.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-11-11 19:29:15 [main] ERROR i.n.r.d.DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
2025-11-11 19:29:15 [main] INFO  c.d.w.s.impl.FileStorageServiceImpl - 文件上传目录: /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 19:29:16 [main] INFO  c.d.message.worker.SmsSendWorker - SmsSendWorker started
2025-11-11 19:29:16 [main] INFO  c.deepreach.web.config.WebMvcConfig - 静态资源映射配置：/uploads/** -> file:/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 19:29:16 [main] INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@57df93c1, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@72998021, org.springframework.security.web.context.SecurityContextHolderFilter@4e111e08, org.springframework.security.web.header.HeaderWriterFilter@5cb6b81b, org.springframework.web.filter.CorsFilter@761a0bbd, org.springframework.security.web.authentication.logout.LogoutFilter@3a5b1af7, com.deepreach.common.security.JwtAuthenticationFilter@528f5b7f, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@7bc4ac3e, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@504274c1, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@7a6e0f3c, org.springframework.security.web.session.SessionManagementFilter@18ad085a, org.springframework.security.web.access.ExceptionTranslationFilter@551725e4, org.springframework.security.web.access.intercept.AuthorizationFilter@7e1953f7]
2025-11-11 19:29:16 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-11 19:29:17 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:29:17 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:29:17 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:29:17 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:29:17 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762860557027
2025-11-11 19:29:17 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Subscribed to topic(s): translation-charge
2025-11-11 19:29:17 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:29:17 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:29:17 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:29:17 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:29:17 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762860557034
2025-11-11 19:29:17 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Subscribed to topic(s): translation-charge
2025-11-11 19:29:17 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:29:17 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:29:17 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:29:17 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:29:17 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762860557037
2025-11-11 19:29:17 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Subscribed to topic(s): translation-charge
2025-11-11 19:29:17 [main] INFO  c.deepreach.web.DeepReachApplication - Started DeepReachApplication in 2.846 seconds (process running for 3.123)
2025-11-11 19:29:17 [main] INFO  c.d.web.config.DataSourceHealthCheck - 开始检查数据源配置...
2025-11-11 19:29:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:29:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:29:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:29:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:29:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:29:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:29:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:29:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:29:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:29:18 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-2-43c76ea3-68ea-4f98-975a-82785987b6de
2025-11-11 19:29:18 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:29:18 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:29:18 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-3-af92690a-02f4-4122-8640-3b4dc0fdf4dc
2025-11-11 19:29:18 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:29:18 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:29:18 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-1-c68cd545-000b-42e6-8a2e-246e037cd80c
2025-11-11 19:29:18 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:29:18 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:29:21 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Successfully joined group with generation Generation{generationId=13, memberId='consumer-deepreach-translation-2-43c76ea3-68ea-4f98-975a-82785987b6de', protocol='range'}
2025-11-11 19:29:21 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Successfully joined group with generation Generation{generationId=13, memberId='consumer-deepreach-translation-3-af92690a-02f4-4122-8640-3b4dc0fdf4dc', protocol='range'}
2025-11-11 19:29:21 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Successfully joined group with generation Generation{generationId=13, memberId='consumer-deepreach-translation-1-c68cd545-000b-42e6-8a2e-246e037cd80c', protocol='range'}
2025-11-11 19:29:21 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Finished assignment for group at generation 13: {consumer-deepreach-translation-3-af92690a-02f4-4122-8640-3b4dc0fdf4dc=Assignment(partitions=[translation-charge-2]), consumer-deepreach-translation-1-c68cd545-000b-42e6-8a2e-246e037cd80c=Assignment(partitions=[translation-charge-0]), consumer-deepreach-translation-2-43c76ea3-68ea-4f98-975a-82785987b6de=Assignment(partitions=[translation-charge-1])}
2025-11-11 19:29:21 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Successfully synced group in generation Generation{generationId=13, memberId='consumer-deepreach-translation-2-43c76ea3-68ea-4f98-975a-82785987b6de', protocol='range'}
2025-11-11 19:29:21 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Notifying assignor about the new Assignment(partitions=[translation-charge-1])
2025-11-11 19:29:21 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Successfully synced group in generation Generation{generationId=13, memberId='consumer-deepreach-translation-1-c68cd545-000b-42e6-8a2e-246e037cd80c', protocol='range'}
2025-11-11 19:29:21 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Notifying assignor about the new Assignment(partitions=[translation-charge-0])
2025-11-11 19:29:21 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Adding newly assigned partitions: translation-charge-0
2025-11-11 19:29:21 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Adding newly assigned partitions: translation-charge-1
2025-11-11 19:29:21 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Setting offset for partition translation-charge-0 to the committed offset FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:29:21 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions assigned: [translation-charge-0]
2025-11-11 19:29:21 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Successfully synced group in generation Generation{generationId=13, memberId='consumer-deepreach-translation-3-af92690a-02f4-4122-8640-3b4dc0fdf4dc', protocol='range'}
2025-11-11 19:29:21 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Notifying assignor about the new Assignment(partitions=[translation-charge-2])
2025-11-11 19:29:21 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Adding newly assigned partitions: translation-charge-2
2025-11-11 19:29:22 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Setting offset for partition translation-charge-2 to the committed offset FetchPosition{offset=10, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:29:22 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions assigned: [translation-charge-2]
2025-11-11 19:29:22 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Setting offset for partition translation-charge-1 to the committed offset FetchPosition{offset=2, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:29:22 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions assigned: [translation-charge-1]
2025-11-11 19:29:32 [main] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-11-11 19:29:32 [main] INFO  c.d.web.config.DataSourceHealthCheck - 主数据源连接成功: PRIMARY_OK
2025-11-11 19:29:35 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据源连接成功: CLOUD_COMPUTER_OK
2025-11-11 19:29:37 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据库中admin用户记录数: 0
2025-11-11 19:29:37 [main] INFO  c.d.web.config.DataSourceHealthCheck - 数据源检查完成
2025-11-11 19:29:37 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 开始构建用户层级树缓存...
2025-11-11 19:29:37 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==>  Preparing: SELECT u.user_id AS userId, u.parent_user_id AS parentUserId FROM sys_user u WHERE u.status = '0'
2025-11-11 19:29:37 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==> Parameters: 
2025-11-11 19:29:38 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - <==      Total: 72
2025-11-11 19:29:38 [main] INFO  c.d.c.c.s.impl.SysUserServiceImpl - 用户层级树缓存刷新成功：记录总数=72, 根节点数量=1
2025-11-11 19:29:38 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 用户层级树缓存构建完成
2025-11-11 19:29:40 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-11 19:29:40 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-11 19:29:40 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-11-11 19:29:40 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 19:29:40 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 19:29:40 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 19:29:40 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 19:29:40 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 19:29:40 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:29:40 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 19:29:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 19:29:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:29:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 19:29:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 19:29:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 19:29:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 19:29:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 19:29:41 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 19:29:41 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 19:29:41 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 19:29:41 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 19:29:41 [http-nio-8080-exec-2] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 19:29:41 [http-nio-8080-exec-2] WARN  o.s.w.s.h.HandlerMappingIntrospector - Cache miss for REQUEST dispatch to '/api/translate' (previous null). Performing MatchableHandlerMapping lookup. This is logged once only at WARN level, and every time at TRACE.
2025-11-11 19:29:41 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 19:29:41 [http-nio-8080-exec-2] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 19:29:41 [http-nio-8080-exec-2] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-0
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-0
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:29:41 [http-nio-8080-exec-2] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Instantiated a transactional producer.
2025-11-11 19:29:41 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:29:41 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:29:41 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762860581526
2025-11-11 19:29:41 [http-nio-8080-exec-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:29:42 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:29:42 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:29:43 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] ProducerId set to 0 with epoch 5
2025-11-11 19:29:43 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:29:43 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:29:43 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:29:43 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:29:43 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 19:29:43 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:29:43 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:29:43 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 19:29:43 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:29:43 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:29:43 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 19:29:43 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:29:43 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:29:43 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 19:29:43 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:29:43 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:29:43 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:29:44 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:29:48 [http-nio-8080-exec-2] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 117 tokens
2025-11-11 19:29:48 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 19:29:48 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if it's this interface 😈(String), en(String)
2025-11-11 19:29:48 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 19:29:48 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:29:48 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:29:48 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:29:48 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:29:48 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:29:49 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:29:49 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:29:49 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 19:29:49 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:29:49 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:29:49 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 19:29:49 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:29:49 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:29:49 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 19:29:49 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:29:49 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:29:49 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 19:29:49 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:29:49 [http-nio-8080-exec-2] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-1
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-1
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:29:49 [http-nio-8080-exec-2] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Instantiated a transactional producer.
2025-11-11 19:29:49 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:29:49 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:29:49 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762860589983
2025-11-11 19:29:49 [http-nio-8080-exec-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:29:50 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:29:50 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:29:52 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] ProducerId set to 1 with epoch 5
2025-11-11 19:29:54 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-2
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-2
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:29:54 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Instantiated a transactional producer.
2025-11-11 19:29:54 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:29:54 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:29:54 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762860594664
2025-11-11 19:29:54 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:29:55 [http-nio-8080-exec-2] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=a47c12c0-76a5-42dd-a76f-6729ee1b1a05, amount=0.000117
2025-11-11 19:29:55 [http-nio-8080-exec-2] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=117, amount=0.000117
2025-11-11 19:29:55 [http-nio-8080-exec-2] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=117
2025-11-11 19:29:55 [http-nio-8080-exec-2] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 14000ms
2025-11-11 19:29:55 [http-nio-8080-exec-2] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 14000ms - 超过阈值: 3000ms
2025-11-11 19:29:55 [kafka-producer-network-thread | producer-deepreach-translate-tx-2] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:29:55 [kafka-producer-network-thread | producer-deepreach-translate-tx-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:29:56 [kafka-producer-network-thread | producer-deepreach-translate-tx-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] ProducerId set to 2 with epoch 2
2025-11-11 19:29:56 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:29:56 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:29:56 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:29:56 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 19:29:56 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.096152(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.903848(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.139348(BigDecimal), 342(Long), 1266(Integer)
2025-11-11 19:29:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 19:29:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:29:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:29:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:29:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=a47c12c0-76a5-42dd-a76f-6729ee1b1a05 chargeUserId=342 amount=0.000117
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Revoke previously assigned partitions translation-charge-2
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Revoke previously assigned partitions translation-charge-0
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Revoke previously assigned partitions translation-charge-1
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions revoked: [translation-charge-1]
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions revoked: [translation-charge-2]
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions revoked: [translation-charge-0]
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Member consumer-deepreach-translation-3-af92690a-02f4-4122-8640-3b4dc0fdf4dc sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Member consumer-deepreach-translation-1-c68cd545-000b-42e6-8a2e-246e037cd80c sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Member consumer-deepreach-translation-2-43c76ea3-68ea-4f98-975a-82785987b6de sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-2 unregistered
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: Consumer stopped
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-1 unregistered
2025-11-11 19:34:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: Consumer stopped
2025-11-11 19:34:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:34:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:34:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:34:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-3 unregistered
2025-11-11 19:34:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: Consumer stopped
2025-11-11 19:34:32 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:34:32 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:34:32 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:34:32 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:34:32 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-1 unregistered
2025-11-11 19:34:32 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:34:32 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:34:32 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:34:32 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:34:32 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-0 unregistered
2025-11-11 19:34:32 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:34:32 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:34:32 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:34:32 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:34:32 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-2 unregistered
2025-11-11 19:34:32 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-11-11 19:34:32 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-11-11 19:35:24 [main] INFO  c.deepreach.web.DeepReachApplication - Starting DeepReachApplication using Java 17.0.12 with PID 49506 (/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/deepreach-web/target/classes started by gak1 in /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild)
2025-11-11 19:35:24 [main] DEBUG c.deepreach.web.DeepReachApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-11 19:35:24 [main] INFO  c.deepreach.web.DeepReachApplication - The following 1 profile is active: "dev"
2025-11-11 19:35:25 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-11 19:35:25 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-11 19:35:25 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2025-11-11 19:35:25 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-11 19:35:25 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-11 19:35:25 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-11 19:35:25 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-11 19:35:25 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 861 ms
2025-11-11 19:35:25 [main] DEBUG c.d.c.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-11-11 19:35:25 [main] ERROR i.n.r.d.DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
2025-11-11 19:35:26 [main] INFO  c.d.w.s.impl.FileStorageServiceImpl - 文件上传目录: /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 19:35:26 [main] INFO  c.d.message.worker.SmsSendWorker - SmsSendWorker started
2025-11-11 19:35:26 [main] INFO  c.deepreach.web.config.WebMvcConfig - 静态资源映射配置：/uploads/** -> file:/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 19:35:26 [main] INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@7e1953f7, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@26f07261, org.springframework.security.web.context.SecurityContextHolderFilter@396519b, org.springframework.security.web.header.HeaderWriterFilter@3333245e, org.springframework.web.filter.CorsFilter@2b55ea4d, org.springframework.security.web.authentication.logout.LogoutFilter@8942ece, com.deepreach.common.security.JwtAuthenticationFilter@3a3316b6, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@15ea0ca3, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@7f3a92fd, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@63ede2a0, org.springframework.security.web.session.SessionManagementFilter@6eeeb9da, org.springframework.security.web.access.ExceptionTranslationFilter@136a4800, org.springframework.security.web.access.intercept.AuthorizationFilter@60256d1b]
2025-11-11 19:35:26 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-11 19:35:26 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:35:26 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:35:26 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:35:26 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:35:26 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762860926969
2025-11-11 19:35:26 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Subscribed to topic(s): translation-charge
2025-11-11 19:35:26 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:35:26 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:35:26 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:35:26 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:35:26 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762860926973
2025-11-11 19:35:26 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Subscribed to topic(s): translation-charge
2025-11-11 19:35:26 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:35:26 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:35:26 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:35:26 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:35:26 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762860926975
2025-11-11 19:35:26 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Subscribed to topic(s): translation-charge
2025-11-11 19:35:26 [main] INFO  c.deepreach.web.DeepReachApplication - Started DeepReachApplication in 2.611 seconds (process running for 2.949)
2025-11-11 19:35:26 [main] INFO  c.d.web.config.DataSourceHealthCheck - 开始检查数据源配置...
2025-11-11 19:35:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:35:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:35:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:35:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:35:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:35:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:35:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:35:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:35:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:35:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-1-3d3ad609-97fc-41fe-9de5-9f66208d74a5
2025-11-11 19:35:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:35:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:35:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-2-9b53b3e2-e9ba-4cb3-b5ff-7bbf2f6f371d
2025-11-11 19:35:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:35:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:35:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-3-158b54be-0d5b-4376-a327-24d3cdde37cf
2025-11-11 19:35:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:35:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] (Re-)joining group
2025-11-11 19:35:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Successfully joined group with generation Generation{generationId=15, memberId='consumer-deepreach-translation-2-9b53b3e2-e9ba-4cb3-b5ff-7bbf2f6f371d', protocol='range'}
2025-11-11 19:35:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Successfully joined group with generation Generation{generationId=15, memberId='consumer-deepreach-translation-1-3d3ad609-97fc-41fe-9de5-9f66208d74a5', protocol='range'}
2025-11-11 19:35:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Successfully joined group with generation Generation{generationId=15, memberId='consumer-deepreach-translation-3-158b54be-0d5b-4376-a327-24d3cdde37cf', protocol='range'}
2025-11-11 19:35:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Finished assignment for group at generation 15: {consumer-deepreach-translation-3-158b54be-0d5b-4376-a327-24d3cdde37cf=Assignment(partitions=[translation-charge-2]), consumer-deepreach-translation-1-3d3ad609-97fc-41fe-9de5-9f66208d74a5=Assignment(partitions=[translation-charge-0]), consumer-deepreach-translation-2-9b53b3e2-e9ba-4cb3-b5ff-7bbf2f6f371d=Assignment(partitions=[translation-charge-1])}
2025-11-11 19:35:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Successfully synced group in generation Generation{generationId=15, memberId='consumer-deepreach-translation-2-9b53b3e2-e9ba-4cb3-b5ff-7bbf2f6f371d', protocol='range'}
2025-11-11 19:35:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Successfully synced group in generation Generation{generationId=15, memberId='consumer-deepreach-translation-1-3d3ad609-97fc-41fe-9de5-9f66208d74a5', protocol='range'}
2025-11-11 19:35:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Notifying assignor about the new Assignment(partitions=[translation-charge-0])
2025-11-11 19:35:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Notifying assignor about the new Assignment(partitions=[translation-charge-1])
2025-11-11 19:35:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Successfully synced group in generation Generation{generationId=15, memberId='consumer-deepreach-translation-3-158b54be-0d5b-4376-a327-24d3cdde37cf', protocol='range'}
2025-11-11 19:35:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Notifying assignor about the new Assignment(partitions=[translation-charge-2])
2025-11-11 19:35:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Adding newly assigned partitions: translation-charge-0
2025-11-11 19:35:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Adding newly assigned partitions: translation-charge-2
2025-11-11 19:35:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Adding newly assigned partitions: translation-charge-1
2025-11-11 19:35:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Setting offset for partition translation-charge-0 to the committed offset FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:35:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Setting offset for partition translation-charge-2 to the committed offset FetchPosition{offset=10, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:35:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Setting offset for partition translation-charge-1 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:35:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions assigned: [translation-charge-1]
2025-11-11 19:35:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions assigned: [translation-charge-0]
2025-11-11 19:35:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions assigned: [translation-charge-2]
2025-11-11 19:35:34 [main] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-11-11 19:35:34 [main] INFO  c.d.web.config.DataSourceHealthCheck - 主数据源连接成功: PRIMARY_OK
2025-11-11 19:35:36 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据源连接成功: CLOUD_COMPUTER_OK
2025-11-11 19:35:37 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据库中admin用户记录数: 0
2025-11-11 19:35:37 [main] INFO  c.d.web.config.DataSourceHealthCheck - 数据源检查完成
2025-11-11 19:35:37 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 开始构建用户层级树缓存...
2025-11-11 19:35:37 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==>  Preparing: SELECT u.user_id AS userId, u.parent_user_id AS parentUserId FROM sys_user u WHERE u.status = '0'
2025-11-11 19:35:37 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==> Parameters: 
2025-11-11 19:35:38 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - <==      Total: 72
2025-11-11 19:35:38 [main] INFO  c.d.c.c.s.impl.SysUserServiceImpl - 用户层级树缓存刷新成功：记录总数=72, 根节点数量=1
2025-11-11 19:35:38 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 用户层级树缓存构建完成
2025-11-11 19:35:41 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-11 19:35:41 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-11 19:35:41 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 19:35:41 [http-nio-8080-exec-2] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 19:35:41 [http-nio-8080-exec-2] WARN  o.s.w.s.h.HandlerMappingIntrospector - Cache miss for REQUEST dispatch to '/api/translate' (previous null). Performing MatchableHandlerMapping lookup. This is logged once only at WARN level, and every time at TRACE.
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 19:35:41 [http-nio-8080-exec-2] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 19:35:41 [http-nio-8080-exec-2] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-0
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-0
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:35:41 [http-nio-8080-exec-2] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Instantiated a transactional producer.
2025-11-11 19:35:41 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:35:41 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:35:41 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762860941727
2025-11-11 19:35:41 [http-nio-8080-exec-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:35:42 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:35:42 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:35:43 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] ProducerId set to 0 with epoch 6
2025-11-11 19:35:43 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:35:43 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:35:44 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:35:44 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:35:44 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 19:35:44 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:35:44 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:35:44 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 19:35:44 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:35:44 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:35:44 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 19:35:44 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:35:44 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:35:44 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 19:35:44 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:35:44 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:35:44 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:35:45 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:35:46 [http-nio-8080-exec-2] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 119 tokens
2025-11-11 19:35:46 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 19:35:46 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if this is the right one? 😈(String), en(String)
2025-11-11 19:35:47 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 19:35:47 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:35:47 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:35:47 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:35:47 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:35:47 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:35:47 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:35:47 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:35:47 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 19:35:48 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:35:48 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:35:48 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 19:35:48 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:35:48 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:35:48 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 19:35:48 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:35:48 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:35:48 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 19:35:48 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:35:48 [http-nio-8080-exec-2] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-1
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-1
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:35:48 [http-nio-8080-exec-2] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Instantiated a transactional producer.
2025-11-11 19:35:48 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:35:48 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:35:48 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762860948685
2025-11-11 19:35:48 [http-nio-8080-exec-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:35:49 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:35:49 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:35:49 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] ProducerId set to 1 with epoch 6
2025-11-11 19:35:50 [http-nio-8080-exec-2] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=fe706c2f-1373-4749-a991-b2657f109d8f, amount=0.000119
2025-11-11 19:35:51 [http-nio-8080-exec-2] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=119, amount=0.000119
2025-11-11 19:35:51 [http-nio-8080-exec-2] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=119
2025-11-11 19:35:51 [http-nio-8080-exec-2] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 9408ms
2025-11-11 19:35:51 [http-nio-8080-exec-2] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 9408ms - 超过阈值: 3000ms
2025-11-11 19:35:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:35:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:35:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:35:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 19:35:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.096033(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.903967(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.139467(BigDecimal), 342(Long), 1267(Integer)
2025-11-11 19:35:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 19:35:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:35:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:35:52 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:35:52 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=fe706c2f-1373-4749-a991-b2657f109d8f chargeUserId=342 amount=0.000119
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Revoke previously assigned partitions translation-charge-2
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Revoke previously assigned partitions translation-charge-1
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Revoke previously assigned partitions translation-charge-0
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions revoked: [translation-charge-2]
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions revoked: [translation-charge-1]
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: partitions revoked: [translation-charge-0]
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Member consumer-deepreach-translation-3-158b54be-0d5b-4376-a327-24d3cdde37cf sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Member consumer-deepreach-translation-2-9b53b3e2-e9ba-4cb3-b5ff-7bbf2f6f371d sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Member consumer-deepreach-translation-1-3d3ad609-97fc-41fe-9de5-9f66208d74a5 sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-3, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-1, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:40:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-2, groupId=deepreach-translation] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:40:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:40:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:40:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:40:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-3 unregistered
2025-11-11 19:40:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: Consumer stopped
2025-11-11 19:40:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:40:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:40:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:40:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-2 unregistered
2025-11-11 19:40:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: Consumer stopped
2025-11-11 19:40:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:40:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:40:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:40:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-1 unregistered
2025-11-11 19:40:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation: Consumer stopped
2025-11-11 19:40:38 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:40:38 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:40:38 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:40:38 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:40:38 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-0 unregistered
2025-11-11 19:40:38 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:40:38 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:40:38 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:40:38 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:40:38 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-1 unregistered
2025-11-11 19:40:38 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-11-11 19:40:38 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-11-11 19:40:54 [main] INFO  c.deepreach.web.DeepReachApplication - Starting DeepReachApplication using Java 17.0.12 with PID 49700 (/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/deepreach-web/target/classes started by gak1 in /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild)
2025-11-11 19:40:54 [main] DEBUG c.deepreach.web.DeepReachApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-11 19:40:54 [main] INFO  c.deepreach.web.DeepReachApplication - The following 1 profile is active: "dev"
2025-11-11 19:40:54 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-11 19:40:54 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-11 19:40:54 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2025-11-11 19:40:54 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-11 19:40:54 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-11 19:40:54 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-11 19:40:54 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-11 19:40:54 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 866 ms
2025-11-11 19:40:55 [main] DEBUG c.d.c.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-11-11 19:40:55 [main] ERROR i.n.r.d.DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
2025-11-11 19:40:55 [main] INFO  c.d.w.s.impl.FileStorageServiceImpl - 文件上传目录: /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 19:40:55 [main] INFO  c.d.message.worker.SmsSendWorker - SmsSendWorker started
2025-11-11 19:40:56 [main] INFO  c.deepreach.web.config.WebMvcConfig - 静态资源映射配置：/uploads/** -> file:/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 19:40:56 [main] INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@26f07261, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@2b55ea4d, org.springframework.security.web.context.SecurityContextHolderFilter@18ad085a, org.springframework.security.web.header.HeaderWriterFilter@147c4523, org.springframework.web.filter.CorsFilter@63ede2a0, org.springframework.security.web.authentication.logout.LogoutFilter@3a89226e, com.deepreach.common.security.JwtAuthenticationFilter@c4551c6, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@7f3a92fd, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@4e111e08, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@57df93c1, org.springframework.security.web.session.SessionManagementFilter@17635531, org.springframework.security.web.access.ExceptionTranslationFilter@14d6ede3, org.springframework.security.web.access.intercept.AuthorizationFilter@24b4f4a]
2025-11-11 19:40:56 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-11 19:40:56 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-v2-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation-v2
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:40:56 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:40:56 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:40:56 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:40:56 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762861256502
2025-11-11 19:40:56 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Subscribed to topic(s): translation-charge
2025-11-11 19:40:56 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-v2-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation-v2
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:40:56 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:40:56 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:40:56 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:40:56 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762861256507
2025-11-11 19:40:56 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Subscribed to topic(s): translation-charge
2025-11-11 19:40:56 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-v2-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation-v2
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:40:56 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:40:56 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:40:56 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:40:56 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762861256509
2025-11-11 19:40:56 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Subscribed to topic(s): translation-charge
2025-11-11 19:40:56 [main] INFO  c.deepreach.web.DeepReachApplication - Started DeepReachApplication in 2.648 seconds (process running for 2.966)
2025-11-11 19:40:56 [main] INFO  c.d.web.config.DataSourceHealthCheck - 开始检查数据源配置...
2025-11-11 19:40:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:40:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:40:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:40:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:40:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:40:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:40:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:40:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:40:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:40:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-v2-3-44ce2fd3-f25c-4df1-8ac0-2936322abbe1
2025-11-11 19:40:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:40:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:40:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-v2-1-c9eb1bee-76a8-4308-9c2b-34176887db2e
2025-11-11 19:40:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:40:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:40:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-v2-2-6bc1309c-2647-4cfa-8917-a3da99f68130
2025-11-11 19:40:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:40:57 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:41:03 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Successfully joined group with generation Generation{generationId=1, memberId='consumer-deepreach-translation-v2-3-44ce2fd3-f25c-4df1-8ac0-2936322abbe1', protocol='range'}
2025-11-11 19:41:03 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Successfully joined group with generation Generation{generationId=1, memberId='consumer-deepreach-translation-v2-2-6bc1309c-2647-4cfa-8917-a3da99f68130', protocol='range'}
2025-11-11 19:41:03 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Finished assignment for group at generation 1: {consumer-deepreach-translation-v2-3-44ce2fd3-f25c-4df1-8ac0-2936322abbe1=Assignment(partitions=[translation-charge-2]), consumer-deepreach-translation-v2-1-c9eb1bee-76a8-4308-9c2b-34176887db2e=Assignment(partitions=[translation-charge-0]), consumer-deepreach-translation-v2-2-6bc1309c-2647-4cfa-8917-a3da99f68130=Assignment(partitions=[translation-charge-1])}
2025-11-11 19:41:03 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Successfully synced group in generation Generation{generationId=1, memberId='consumer-deepreach-translation-v2-3-44ce2fd3-f25c-4df1-8ac0-2936322abbe1', protocol='range'}
2025-11-11 19:41:03 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Notifying assignor about the new Assignment(partitions=[translation-charge-2])
2025-11-11 19:41:03 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Adding newly assigned partitions: translation-charge-2
2025-11-11 19:41:03 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Successfully synced group in generation Generation{generationId=1, memberId='consumer-deepreach-translation-v2-2-6bc1309c-2647-4cfa-8917-a3da99f68130', protocol='range'}
2025-11-11 19:41:03 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Notifying assignor about the new Assignment(partitions=[translation-charge-1])
2025-11-11 19:41:03 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Adding newly assigned partitions: translation-charge-1
2025-11-11 19:41:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Found no committed offset for partition translation-charge-2
2025-11-11 19:41:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Found no committed offset for partition translation-charge-1
2025-11-11 19:41:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Successfully joined group with generation Generation{generationId=1, memberId='consumer-deepreach-translation-v2-1-c9eb1bee-76a8-4308-9c2b-34176887db2e', protocol='range'}
2025-11-11 19:41:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Found no committed offset for partition translation-charge-2
2025-11-11 19:41:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Successfully synced group in generation Generation{generationId=1, memberId='consumer-deepreach-translation-v2-1-c9eb1bee-76a8-4308-9c2b-34176887db2e', protocol='range'}
2025-11-11 19:41:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Notifying assignor about the new Assignment(partitions=[translation-charge-0])
2025-11-11 19:41:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Adding newly assigned partitions: translation-charge-0
2025-11-11 19:41:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Found no committed offset for partition translation-charge-0
2025-11-11 19:41:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.SubscriptionState - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Resetting offset for partition translation-charge-2 to position FetchPosition{offset=10, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}.
2025-11-11 19:41:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions assigned: [translation-charge-2]
2025-11-11 19:41:04 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Found no committed offset for partition translation-charge-0
2025-11-11 19:41:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Found no committed offset for partition translation-charge-1
2025-11-11 19:41:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.SubscriptionState - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Resetting offset for partition translation-charge-1 to position FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}.
2025-11-11 19:41:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.SubscriptionState - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Resetting offset for partition translation-charge-0 to position FetchPosition{offset=8, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}.
2025-11-11 19:41:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions assigned: [translation-charge-1]
2025-11-11 19:41:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions assigned: [translation-charge-0]
2025-11-11 19:41:11 [main] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-11-11 19:41:11 [main] INFO  c.d.web.config.DataSourceHealthCheck - 主数据源连接成功: PRIMARY_OK
2025-11-11 19:41:15 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据源连接成功: CLOUD_COMPUTER_OK
2025-11-11 19:41:17 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据库中admin用户记录数: 0
2025-11-11 19:41:17 [main] INFO  c.d.web.config.DataSourceHealthCheck - 数据源检查完成
2025-11-11 19:41:17 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 开始构建用户层级树缓存...
2025-11-11 19:41:17 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==>  Preparing: SELECT u.user_id AS userId, u.parent_user_id AS parentUserId FROM sys_user u WHERE u.status = '0'
2025-11-11 19:41:17 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==> Parameters: 
2025-11-11 19:41:17 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - <==      Total: 72
2025-11-11 19:41:17 [main] INFO  c.d.c.c.s.impl.SysUserServiceImpl - 用户层级树缓存刷新成功：记录总数=72, 根节点数量=1
2025-11-11 19:41:17 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 用户层级树缓存构建完成
2025-11-11 19:41:21 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-11 19:41:21 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-11 19:41:21 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-11-11 19:41:21 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 19:41:21 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 19:41:21 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 19:41:21 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 19:41:21 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 19:41:21 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:41:21 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 19:41:21 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 19:41:21 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:41:21 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 19:41:22 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 19:41:22 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 19:41:22 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 19:41:22 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 19:41:22 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 19:41:22 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 19:41:22 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 19:41:22 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 19:41:22 [http-nio-8080-exec-2] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 19:41:22 [http-nio-8080-exec-2] WARN  o.s.w.s.h.HandlerMappingIntrospector - Cache miss for REQUEST dispatch to '/api/translate' (previous null). Performing MatchableHandlerMapping lookup. This is logged once only at WARN level, and every time at TRACE.
2025-11-11 19:41:22 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 19:41:22 [http-nio-8080-exec-2] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 19:41:22 [http-nio-8080-exec-2] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-0
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-0
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:41:22 [http-nio-8080-exec-2] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Instantiated a transactional producer.
2025-11-11 19:41:22 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:41:22 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:41:22 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762861282618
2025-11-11 19:41:22 [http-nio-8080-exec-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:41:23 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:41:23 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:41:23 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] ProducerId set to 0 with epoch 7
2025-11-11 19:41:23 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:41:23 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:41:24 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:41:24 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:41:24 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 19:41:24 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:41:24 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:41:24 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 19:41:25 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:41:25 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:41:25 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 19:41:25 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:41:25 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:41:25 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 19:41:25 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:41:25 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:41:25 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:41:25 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:41:27 [http-nio-8080-exec-2] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 118 tokens
2025-11-11 19:41:27 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 19:41:27 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if this is the correct one 😈(String), en(String)
2025-11-11 19:41:27 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 19:41:27 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:41:27 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:41:27 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:41:27 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:41:27 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:41:28 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:41:28 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:41:28 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 19:41:29 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:41:29 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:41:29 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 19:41:29 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:41:29 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:41:29 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 19:41:30 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:41:30 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:41:30 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 19:41:30 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:41:30 [http-nio-8080-exec-2] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-1
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-1
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:41:30 [http-nio-8080-exec-2] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Instantiated a transactional producer.
2025-11-11 19:41:30 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:41:30 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:41:30 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762861290193
2025-11-11 19:41:30 [http-nio-8080-exec-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:41:31 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:41:31 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:41:32 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] ProducerId set to 1 with epoch 7
2025-11-11 19:41:34 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-2
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-2
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:41:34 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Instantiated a transactional producer.
2025-11-11 19:41:34 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:41:34 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:41:34 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762861294297
2025-11-11 19:41:34 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:41:34 [http-nio-8080-exec-2] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=387e5f38-0c80-4c11-9040-eac9df2d5b77, amount=0.000118
2025-11-11 19:41:34 [http-nio-8080-exec-2] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=118, amount=0.000118
2025-11-11 19:41:34 [http-nio-8080-exec-2] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=118
2025-11-11 19:41:34 [http-nio-8080-exec-2] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 12199ms
2025-11-11 19:41:34 [http-nio-8080-exec-2] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 12199ms - 超过阈值: 3000ms
2025-11-11 19:41:35 [kafka-producer-network-thread | producer-deepreach-translate-tx-2] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:41:35 [kafka-producer-network-thread | producer-deepreach-translate-tx-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:41:35 [kafka-producer-network-thread | producer-deepreach-translate-tx-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] ProducerId set to 2 with epoch 3
2025-11-11 19:41:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:41:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:41:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:41:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 19:41:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.095915(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.904085(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.139585(BigDecimal), 342(Long), 1268(Integer)
2025-11-11 19:41:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 19:41:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:41:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:41:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:41:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=387e5f38-0c80-4c11-9040-eac9df2d5b77 chargeUserId=342 amount=0.000118
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Revoke previously assigned partitions translation-charge-2
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Revoke previously assigned partitions translation-charge-1
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Revoke previously assigned partitions translation-charge-0
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions revoked: [translation-charge-1]
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions revoked: [translation-charge-2]
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions revoked: [translation-charge-0]
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Member consumer-deepreach-translation-v2-2-6bc1309c-2647-4cfa-8917-a3da99f68130 sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Member consumer-deepreach-translation-v2-3-44ce2fd3-f25c-4df1-8ac0-2936322abbe1 sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Member consumer-deepreach-translation-v2-1-c9eb1bee-76a8-4308-9c2b-34176887db2e sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-v2-3 unregistered
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: Consumer stopped
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-v2-2 unregistered
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: Consumer stopped
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-v2-1 unregistered
2025-11-11 19:44:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: Consumer stopped
2025-11-11 19:44:47 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:44:47 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:44:47 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:44:47 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:44:47 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-1 unregistered
2025-11-11 19:44:47 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:44:47 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:44:47 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:44:47 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:44:47 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-0 unregistered
2025-11-11 19:44:47 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:44:47 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:44:47 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:44:47 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:44:47 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-2 unregistered
2025-11-11 19:44:47 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-11-11 19:44:47 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-11-11 19:44:48 [main] INFO  c.deepreach.web.DeepReachApplication - Starting DeepReachApplication using Java 17.0.12 with PID 49892 (/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/deepreach-web/target/classes started by gak1 in /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild)
2025-11-11 19:44:48 [main] DEBUG c.deepreach.web.DeepReachApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-11 19:44:48 [main] INFO  c.deepreach.web.DeepReachApplication - The following 1 profile is active: "dev"
2025-11-11 19:44:49 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-11 19:44:49 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-11 19:44:49 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2025-11-11 19:44:49 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-11 19:44:49 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-11 19:44:49 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-11 19:44:49 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-11 19:44:49 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 864 ms
2025-11-11 19:44:50 [main] DEBUG c.d.c.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-11-11 19:44:50 [main] ERROR i.n.r.d.DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
2025-11-11 19:44:50 [main] INFO  c.d.w.s.impl.FileStorageServiceImpl - 文件上传目录: /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 19:44:50 [main] INFO  c.d.message.worker.SmsSendWorker - SmsSendWorker started
2025-11-11 19:44:50 [main] INFO  c.deepreach.web.config.WebMvcConfig - 静态资源映射配置：/uploads/** -> file:/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 19:44:51 [main] INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@26f07261, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@2b55ea4d, org.springframework.security.web.context.SecurityContextHolderFilter@18ad085a, org.springframework.security.web.header.HeaderWriterFilter@147c4523, org.springframework.web.filter.CorsFilter@63ede2a0, org.springframework.security.web.authentication.logout.LogoutFilter@3a89226e, com.deepreach.common.security.JwtAuthenticationFilter@528f5b7f, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@7f3a92fd, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@4e111e08, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@57df93c1, org.springframework.security.web.session.SessionManagementFilter@17635531, org.springframework.security.web.access.ExceptionTranslationFilter@14d6ede3, org.springframework.security.web.access.intercept.AuthorizationFilter@24b4f4a]
2025-11-11 19:44:51 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-11 19:44:51 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-v2-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation-v2
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:44:51 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:44:51 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:44:51 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:44:51 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762861491406
2025-11-11 19:44:51 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Subscribed to topic(s): translation-charge
2025-11-11 19:44:51 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-v2-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation-v2
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:44:51 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:44:51 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:44:51 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:44:51 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762861491410
2025-11-11 19:44:51 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Subscribed to topic(s): translation-charge
2025-11-11 19:44:51 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-v2-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation-v2
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:44:51 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:44:51 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:44:51 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:44:51 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762861491412
2025-11-11 19:44:51 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Subscribed to topic(s): translation-charge
2025-11-11 19:44:51 [main] INFO  c.deepreach.web.DeepReachApplication - Started DeepReachApplication in 2.726 seconds (process running for 2.978)
2025-11-11 19:44:51 [main] INFO  c.d.web.config.DataSourceHealthCheck - 开始检查数据源配置...
2025-11-11 19:44:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:44:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:44:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:44:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:44:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:44:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:44:52 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-v2-2-93fa9a9f-16f3-4a3f-9d0c-484583a1593e
2025-11-11 19:44:52 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:44:52 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:44:52 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:44:52 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:44:52 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:44:52 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-v2-1-f74d4437-060e-4852-911d-388f1c68d4d6
2025-11-11 19:44:52 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:44:52 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:44:53 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-v2-3-2be312f3-bff1-40c4-bac0-d7f1080cd104
2025-11-11 19:44:53 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:44:53 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:44:55 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Successfully joined group with generation Generation{generationId=3, memberId='consumer-deepreach-translation-v2-1-f74d4437-060e-4852-911d-388f1c68d4d6', protocol='range'}
2025-11-11 19:44:55 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Successfully joined group with generation Generation{generationId=3, memberId='consumer-deepreach-translation-v2-3-2be312f3-bff1-40c4-bac0-d7f1080cd104', protocol='range'}
2025-11-11 19:44:55 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Successfully joined group with generation Generation{generationId=3, memberId='consumer-deepreach-translation-v2-2-93fa9a9f-16f3-4a3f-9d0c-484583a1593e', protocol='range'}
2025-11-11 19:44:55 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Finished assignment for group at generation 3: {consumer-deepreach-translation-v2-1-f74d4437-060e-4852-911d-388f1c68d4d6=Assignment(partitions=[translation-charge-0]), consumer-deepreach-translation-v2-2-93fa9a9f-16f3-4a3f-9d0c-484583a1593e=Assignment(partitions=[translation-charge-1]), consumer-deepreach-translation-v2-3-2be312f3-bff1-40c4-bac0-d7f1080cd104=Assignment(partitions=[translation-charge-2])}
2025-11-11 19:44:55 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Successfully synced group in generation Generation{generationId=3, memberId='consumer-deepreach-translation-v2-1-f74d4437-060e-4852-911d-388f1c68d4d6', protocol='range'}
2025-11-11 19:44:55 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Successfully synced group in generation Generation{generationId=3, memberId='consumer-deepreach-translation-v2-3-2be312f3-bff1-40c4-bac0-d7f1080cd104', protocol='range'}
2025-11-11 19:44:55 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Notifying assignor about the new Assignment(partitions=[translation-charge-2])
2025-11-11 19:44:55 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Notifying assignor about the new Assignment(partitions=[translation-charge-0])
2025-11-11 19:44:55 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Adding newly assigned partitions: translation-charge-0
2025-11-11 19:44:55 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Adding newly assigned partitions: translation-charge-2
2025-11-11 19:44:56 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Setting offset for partition translation-charge-0 to the committed offset FetchPosition{offset=8, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:44:56 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Setting offset for partition translation-charge-2 to the committed offset FetchPosition{offset=10, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:44:56 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions assigned: [translation-charge-2]
2025-11-11 19:44:56 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions assigned: [translation-charge-0]
2025-11-11 19:44:56 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Successfully synced group in generation Generation{generationId=3, memberId='consumer-deepreach-translation-v2-2-93fa9a9f-16f3-4a3f-9d0c-484583a1593e', protocol='range'}
2025-11-11 19:44:56 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Notifying assignor about the new Assignment(partitions=[translation-charge-1])
2025-11-11 19:44:56 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Adding newly assigned partitions: translation-charge-1
2025-11-11 19:44:56 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Setting offset for partition translation-charge-1 to the committed offset FetchPosition{offset=5, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:44:56 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions assigned: [translation-charge-1]
2025-11-11 19:45:03 [main] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-11-11 19:45:03 [main] INFO  c.d.web.config.DataSourceHealthCheck - 主数据源连接成功: PRIMARY_OK
2025-11-11 19:45:06 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据源连接成功: CLOUD_COMPUTER_OK
2025-11-11 19:45:08 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据库中admin用户记录数: 0
2025-11-11 19:45:08 [main] INFO  c.d.web.config.DataSourceHealthCheck - 数据源检查完成
2025-11-11 19:45:08 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 开始构建用户层级树缓存...
2025-11-11 19:45:08 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==>  Preparing: SELECT u.user_id AS userId, u.parent_user_id AS parentUserId FROM sys_user u WHERE u.status = '0'
2025-11-11 19:45:08 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==> Parameters: 
2025-11-11 19:45:08 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - <==      Total: 72
2025-11-11 19:45:08 [main] INFO  c.d.c.c.s.impl.SysUserServiceImpl - 用户层级树缓存刷新成功：记录总数=72, 根节点数量=1
2025-11-11 19:45:08 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 用户层级树缓存构建完成
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Revoke previously assigned partitions translation-charge-2
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Revoke previously assigned partitions translation-charge-1
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Revoke previously assigned partitions translation-charge-0
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions revoked: [translation-charge-2]
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions revoked: [translation-charge-0]
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions revoked: [translation-charge-1]
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Member consumer-deepreach-translation-v2-3-2be312f3-bff1-40c4-bac0-d7f1080cd104 sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Member consumer-deepreach-translation-v2-1-f74d4437-060e-4852-911d-388f1c68d4d6 sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Member consumer-deepreach-translation-v2-2-93fa9a9f-16f3-4a3f-9d0c-484583a1593e sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-v2-3 unregistered
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: Consumer stopped
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-v2-2 unregistered
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: Consumer stopped
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-v2-1 unregistered
2025-11-11 19:46:05 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: Consumer stopped
2025-11-11 19:46:06 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-11-11 19:46:06 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-11-11 19:46:07 [main] INFO  c.deepreach.web.DeepReachApplication - Starting DeepReachApplication using Java 17.0.12 with PID 49904 (/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/deepreach-web/target/classes started by gak1 in /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild)
2025-11-11 19:46:07 [main] DEBUG c.deepreach.web.DeepReachApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-11 19:46:07 [main] INFO  c.deepreach.web.DeepReachApplication - The following 1 profile is active: "dev"
2025-11-11 19:46:08 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-11 19:46:08 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-11 19:46:08 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2025-11-11 19:46:08 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-11 19:46:08 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-11 19:46:08 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-11 19:46:08 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-11 19:46:08 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 888 ms
2025-11-11 19:46:08 [main] DEBUG c.d.c.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-11-11 19:46:09 [main] ERROR i.n.r.d.DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
2025-11-11 19:46:09 [main] INFO  c.d.w.s.impl.FileStorageServiceImpl - 文件上传目录: /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 19:46:09 [main] INFO  c.d.message.worker.SmsSendWorker - SmsSendWorker started
2025-11-11 19:46:09 [main] INFO  c.deepreach.web.config.WebMvcConfig - 静态资源映射配置：/uploads/** -> file:/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 19:46:09 [main] INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@24b4f4a, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@5d8a1456, org.springframework.security.web.context.SecurityContextHolderFilter@6eeeb9da, org.springframework.security.web.header.HeaderWriterFilter@2210af14, org.springframework.web.filter.CorsFilter@351fadfa, org.springframework.security.web.authentication.logout.LogoutFilter@6bbb3280, com.deepreach.common.security.JwtAuthenticationFilter@3a3316b6, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@2e488e45, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@396519b, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@7e1953f7, org.springframework.security.web.session.SessionManagementFilter@35198da3, org.springframework.security.web.access.ExceptionTranslationFilter@7bdf8c92, org.springframework.security.web.access.intercept.AuthorizationFilter@3a5b1af7]
2025-11-11 19:46:10 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-11 19:46:10 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-v2-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation-v2
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:46:10 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:46:10 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:46:10 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:46:10 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762861570172
2025-11-11 19:46:10 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Subscribed to topic(s): translation-charge
2025-11-11 19:46:10 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-v2-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation-v2
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:46:10 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:46:10 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:46:10 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:46:10 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762861570176
2025-11-11 19:46:10 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Subscribed to topic(s): translation-charge
2025-11-11 19:46:10 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-v2-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation-v2
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:46:10 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:46:10 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:46:10 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:46:10 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762861570178
2025-11-11 19:46:10 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Subscribed to topic(s): translation-charge
2025-11-11 19:46:10 [main] INFO  c.deepreach.web.DeepReachApplication - Started DeepReachApplication in 2.806 seconds (process running for 3.261)
2025-11-11 19:46:10 [main] INFO  c.d.web.config.DataSourceHealthCheck - 开始检查数据源配置...
2025-11-11 19:46:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:46:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:46:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:46:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:46:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:46:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:46:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-v2-2-2da6b0f2-cf1f-44d7-a3a6-334887cc918e
2025-11-11 19:46:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:46:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:46:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:46:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:46:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:46:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-v2-1-9b2d3ac7-af82-4d1c-a82e-02d28ddc24d3
2025-11-11 19:46:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:46:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:46:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-v2-3-577e83d0-9187-4c14-8871-0cfd7692ed9e
2025-11-11 19:46:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:46:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:46:14 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Successfully joined group with generation Generation{generationId=5, memberId='consumer-deepreach-translation-v2-3-577e83d0-9187-4c14-8871-0cfd7692ed9e', protocol='range'}
2025-11-11 19:46:14 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Successfully joined group with generation Generation{generationId=5, memberId='consumer-deepreach-translation-v2-2-2da6b0f2-cf1f-44d7-a3a6-334887cc918e', protocol='range'}
2025-11-11 19:46:14 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Finished assignment for group at generation 5: {consumer-deepreach-translation-v2-1-9b2d3ac7-af82-4d1c-a82e-02d28ddc24d3=Assignment(partitions=[translation-charge-0]), consumer-deepreach-translation-v2-2-2da6b0f2-cf1f-44d7-a3a6-334887cc918e=Assignment(partitions=[translation-charge-1]), consumer-deepreach-translation-v2-3-577e83d0-9187-4c14-8871-0cfd7692ed9e=Assignment(partitions=[translation-charge-2])}
2025-11-11 19:46:14 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Successfully synced group in generation Generation{generationId=5, memberId='consumer-deepreach-translation-v2-2-2da6b0f2-cf1f-44d7-a3a6-334887cc918e', protocol='range'}
2025-11-11 19:46:14 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Notifying assignor about the new Assignment(partitions=[translation-charge-1])
2025-11-11 19:46:14 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Adding newly assigned partitions: translation-charge-1
2025-11-11 19:46:14 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Successfully joined group with generation Generation{generationId=5, memberId='consumer-deepreach-translation-v2-1-9b2d3ac7-af82-4d1c-a82e-02d28ddc24d3', protocol='range'}
2025-11-11 19:46:14 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Setting offset for partition translation-charge-1 to the committed offset FetchPosition{offset=5, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:46:14 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions assigned: [translation-charge-1]
2025-11-11 19:46:14 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Successfully synced group in generation Generation{generationId=5, memberId='consumer-deepreach-translation-v2-3-577e83d0-9187-4c14-8871-0cfd7692ed9e', protocol='range'}
2025-11-11 19:46:14 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Notifying assignor about the new Assignment(partitions=[translation-charge-2])
2025-11-11 19:46:14 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Adding newly assigned partitions: translation-charge-2
2025-11-11 19:46:15 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Setting offset for partition translation-charge-2 to the committed offset FetchPosition{offset=10, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:46:15 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions assigned: [translation-charge-2]
2025-11-11 19:46:15 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Successfully synced group in generation Generation{generationId=5, memberId='consumer-deepreach-translation-v2-1-9b2d3ac7-af82-4d1c-a82e-02d28ddc24d3', protocol='range'}
2025-11-11 19:46:15 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Notifying assignor about the new Assignment(partitions=[translation-charge-0])
2025-11-11 19:46:15 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Adding newly assigned partitions: translation-charge-0
2025-11-11 19:46:15 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Setting offset for partition translation-charge-0 to the committed offset FetchPosition{offset=8, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:46:15 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions assigned: [translation-charge-0]
2025-11-11 19:46:19 [main] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-11-11 19:46:19 [main] INFO  c.d.web.config.DataSourceHealthCheck - 主数据源连接成功: PRIMARY_OK
2025-11-11 19:46:21 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据源连接成功: CLOUD_COMPUTER_OK
2025-11-11 19:46:24 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据库中admin用户记录数: 0
2025-11-11 19:46:24 [main] INFO  c.d.web.config.DataSourceHealthCheck - 数据源检查完成
2025-11-11 19:46:24 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 开始构建用户层级树缓存...
2025-11-11 19:46:24 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==>  Preparing: SELECT u.user_id AS userId, u.parent_user_id AS parentUserId FROM sys_user u WHERE u.status = '0'
2025-11-11 19:46:24 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==> Parameters: 
2025-11-11 19:46:24 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - <==      Total: 72
2025-11-11 19:46:24 [main] INFO  c.d.c.c.s.impl.SysUserServiceImpl - 用户层级树缓存刷新成功：记录总数=72, 根节点数量=1
2025-11-11 19:46:24 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 用户层级树缓存构建完成
2025-11-11 19:46:26 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-11 19:46:26 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-11 19:46:26 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-11 19:46:26 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 19:46:26 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 19:46:26 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 19:46:26 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 19:46:26 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 19:46:26 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:46:26 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 19:46:26 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 19:46:26 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:46:26 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 19:46:27 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 19:46:27 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 19:46:27 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 19:46:27 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 19:46:27 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 19:46:27 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 19:46:27 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 19:46:27 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 19:46:27 [http-nio-8080-exec-2] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 19:46:27 [http-nio-8080-exec-2] WARN  o.s.w.s.h.HandlerMappingIntrospector - Cache miss for REQUEST dispatch to '/api/translate' (previous null). Performing MatchableHandlerMapping lookup. This is logged once only at WARN level, and every time at TRACE.
2025-11-11 19:46:27 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 19:46:27 [http-nio-8080-exec-2] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 19:46:27 [http-nio-8080-exec-2] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-0
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-0
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:46:27 [http-nio-8080-exec-2] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Instantiated a transactional producer.
2025-11-11 19:46:27 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:46:27 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:46:27 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762861587638
2025-11-11 19:46:27 [http-nio-8080-exec-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:46:28 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:46:28 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:46:28 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] ProducerId set to 0 with epoch 8
2025-11-11 19:46:28 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:46:28 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:46:28 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:46:28 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:46:28 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 19:46:28 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:46:28 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:46:28 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 19:46:29 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:46:29 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:46:29 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 19:46:29 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:46:29 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:46:29 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 19:46:29 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:46:29 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:46:29 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:46:29 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:46:30 [http-nio-8080-exec-2] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 119 tokens
2025-11-11 19:46:30 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 19:46:30 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if this is the right one? 😈(String), en(String)
2025-11-11 19:46:31 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 19:46:31 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:46:31 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:46:31 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:46:31 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:46:31 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:46:31 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:46:31 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:46:31 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 19:46:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:46:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:46:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 19:46:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:46:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:46:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 19:46:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:46:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:46:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 19:46:32 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:46:32 [http-nio-8080-exec-2] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-1
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-1
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:46:32 [http-nio-8080-exec-2] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Instantiated a transactional producer.
2025-11-11 19:46:32 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:46:32 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:46:32 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762861592558
2025-11-11 19:46:32 [http-nio-8080-exec-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:46:33 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:46:33 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:46:34 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] ProducerId set to 1 with epoch 8
2025-11-11 19:46:35 [http-nio-8080-exec-2] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=113cb1a4-bd75-4443-aea4-19e987027807, amount=0.000119
2025-11-11 19:46:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-2
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-2
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:46:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Instantiated a transactional producer.
2025-11-11 19:46:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:46:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:46:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762861595332
2025-11-11 19:46:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:46:35 [http-nio-8080-exec-2] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=119, amount=0.000119
2025-11-11 19:46:35 [http-nio-8080-exec-2] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=119
2025-11-11 19:46:35 [http-nio-8080-exec-2] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 7766ms
2025-11-11 19:46:35 [http-nio-8080-exec-2] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 7766ms - 超过阈值: 3000ms
2025-11-11 19:46:35 [kafka-producer-network-thread | producer-deepreach-translate-tx-2] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:46:35 [kafka-producer-network-thread | producer-deepreach-translate-tx-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:46:36 [kafka-producer-network-thread | producer-deepreach-translate-tx-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] ProducerId set to 2 with epoch 4
2025-11-11 19:46:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:46:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:46:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:46:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 19:46:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.095796(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.904204(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.139704(BigDecimal), 342(Long), 1269(Integer)
2025-11-11 19:46:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 19:46:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:46:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:46:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:46:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=113cb1a4-bd75-4443-aea4-19e987027807 chargeUserId=342 amount=0.000119
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Revoke previously assigned partitions translation-charge-1
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Revoke previously assigned partitions translation-charge-2
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Revoke previously assigned partitions translation-charge-0
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions revoked: [translation-charge-2]
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions revoked: [translation-charge-0]
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions revoked: [translation-charge-1]
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Member consumer-deepreach-translation-v2-3-577e83d0-9187-4c14-8871-0cfd7692ed9e sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Member consumer-deepreach-translation-v2-2-2da6b0f2-cf1f-44d7-a3a6-334887cc918e sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Member consumer-deepreach-translation-v2-1-9b2d3ac7-af82-4d1c-a82e-02d28ddc24d3 sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-v2-2 unregistered
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: Consumer stopped
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-v2-1 unregistered
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: Consumer stopped
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-v2-3 unregistered
2025-11-11 19:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: Consumer stopped
2025-11-11 19:51:39 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:51:39 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:51:39 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:51:39 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:51:39 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-1 unregistered
2025-11-11 19:51:39 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:51:39 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:51:39 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:51:39 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:51:39 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-0 unregistered
2025-11-11 19:51:39 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-2, transactionalId=deepreach-translate-tx-2] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 19:51:39 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 19:51:39 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 19:51:39 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 19:51:39 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-2 unregistered
2025-11-11 19:51:39 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-11-11 19:51:39 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-11-11 19:53:24 [main] INFO  c.deepreach.web.DeepReachApplication - Starting DeepReachApplication using Java 17.0.12 with PID 50172 (/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/deepreach-web/target/classes started by gak1 in /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild)
2025-11-11 19:53:24 [main] DEBUG c.deepreach.web.DeepReachApplication - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-11 19:53:24 [main] INFO  c.deepreach.web.DeepReachApplication - The following 1 profile is active: "dev"
2025-11-11 19:53:25 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-11 19:53:25 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-11 19:53:25 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-11-11 19:53:25 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-11 19:53:25 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-11 19:53:25 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-11 19:53:25 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-11 19:53:25 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 863 ms
2025-11-11 19:53:26 [main] DEBUG c.d.c.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-11-11 19:53:26 [main] ERROR i.n.r.d.DnsServerAddressStreamProviders - Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'. Use DEBUG level to see the full stack: java.lang.UnsatisfiedLinkError: failed to load the required native library
2025-11-11 19:53:26 [main] INFO  c.d.w.s.impl.FileStorageServiceImpl - 文件上传目录: /Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 19:53:26 [main] INFO  c.d.message.worker.SmsSendWorker - SmsSendWorker started
2025-11-11 19:53:26 [main] INFO  c.deepreach.web.config.WebMvcConfig - 静态资源映射配置：/uploads/** -> file:/Users/gak1/Documents/GitHub/deepreach-Server-side-rebuild/uploads
2025-11-11 19:53:26 [main] INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@351fadfa, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7e1953f7, org.springframework.security.web.context.SecurityContextHolderFilter@2e488e45, org.springframework.security.web.header.HeaderWriterFilter@14d6ede3, org.springframework.web.filter.CorsFilter@26f07261, org.springframework.security.web.authentication.logout.LogoutFilter@3e371088, com.deepreach.common.security.JwtAuthenticationFilter@c4551c6, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@18ad085a, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@15ea0ca3, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@2b55ea4d, org.springframework.security.web.session.SessionManagementFilter@7fba492e, org.springframework.security.web.access.ExceptionTranslationFilter@2210af14, org.springframework.security.web.access.intercept.AuthorizationFilter@7603cfc2]
2025-11-11 19:53:27 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-11 19:53:27 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-v2-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation-v2
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:53:27 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:53:27 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:53:27 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:53:27 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762862007206
2025-11-11 19:53:27 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Subscribed to topic(s): translation-charge
2025-11-11 19:53:27 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-v2-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation-v2
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:53:27 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:53:27 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:53:27 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:53:27 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762862007211
2025-11-11 19:53:27 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Subscribed to topic(s): translation-charge
2025-11-11 19:53:27 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [206.82.1.18:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-deepreach-translation-v2-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = deepreach-translation-v2
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-11-11 19:53:27 [main] INFO  o.a.k.c.consumer.ConsumerConfig - These configurations '[spring.json.trusted.packages, spring.json.value.default.type]' were supplied but are not used yet.
2025-11-11 19:53:27 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:53:27 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:53:27 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762862007213
2025-11-11 19:53:27 [main] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Subscribed to topic(s): translation-charge
2025-11-11 19:53:27 [main] INFO  c.deepreach.web.DeepReachApplication - Started DeepReachApplication in 2.623 seconds (process running for 2.982)
2025-11-11 19:53:27 [main] INFO  c.d.web.config.DataSourceHealthCheck - 开始检查数据源配置...
2025-11-11 19:53:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:53:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:53:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:53:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:53:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:53:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:53:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:53:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Discovered group coordinator 206.82.1.18:9092 (id: 2147483646 rack: null)
2025-11-11 19:53:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:53:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-v2-3-d83d9ae9-3d9a-428d-9e4f-4fb5b20e3368
2025-11-11 19:53:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:53:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:53:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-v2-2-058a019c-f582-426c-93ca-226bacb79e03
2025-11-11 19:53:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:53:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:53:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Request joining group due to: need to re-join with the given member-id: consumer-deepreach-translation-v2-1-c8026b68-72e9-4a39-9b9a-2bde6300391d
2025-11-11 19:53:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2025-11-11 19:53:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] (Re-)joining group
2025-11-11 19:53:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Successfully joined group with generation Generation{generationId=7, memberId='consumer-deepreach-translation-v2-3-d83d9ae9-3d9a-428d-9e4f-4fb5b20e3368', protocol='range'}
2025-11-11 19:53:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Successfully joined group with generation Generation{generationId=7, memberId='consumer-deepreach-translation-v2-1-c8026b68-72e9-4a39-9b9a-2bde6300391d', protocol='range'}
2025-11-11 19:53:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Finished assignment for group at generation 7: {consumer-deepreach-translation-v2-1-c8026b68-72e9-4a39-9b9a-2bde6300391d=Assignment(partitions=[translation-charge-0]), consumer-deepreach-translation-v2-2-058a019c-f582-426c-93ca-226bacb79e03=Assignment(partitions=[translation-charge-1]), consumer-deepreach-translation-v2-3-d83d9ae9-3d9a-428d-9e4f-4fb5b20e3368=Assignment(partitions=[translation-charge-2])}
2025-11-11 19:53:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Successfully synced group in generation Generation{generationId=7, memberId='consumer-deepreach-translation-v2-3-d83d9ae9-3d9a-428d-9e4f-4fb5b20e3368', protocol='range'}
2025-11-11 19:53:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Notifying assignor about the new Assignment(partitions=[translation-charge-2])
2025-11-11 19:53:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Successfully synced group in generation Generation{generationId=7, memberId='consumer-deepreach-translation-v2-1-c8026b68-72e9-4a39-9b9a-2bde6300391d', protocol='range'}
2025-11-11 19:53:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Notifying assignor about the new Assignment(partitions=[translation-charge-0])
2025-11-11 19:53:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Adding newly assigned partitions: translation-charge-0
2025-11-11 19:53:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Adding newly assigned partitions: translation-charge-2
2025-11-11 19:53:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Successfully joined group with generation Generation{generationId=7, memberId='consumer-deepreach-translation-v2-2-058a019c-f582-426c-93ca-226bacb79e03', protocol='range'}
2025-11-11 19:53:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Setting offset for partition translation-charge-2 to the committed offset FetchPosition{offset=10, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:53:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Setting offset for partition translation-charge-0 to the committed offset FetchPosition{offset=8, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:53:32 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions assigned: [translation-charge-0]
2025-11-11 19:53:32 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions assigned: [translation-charge-2]
2025-11-11 19:53:32 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Successfully synced group in generation Generation{generationId=7, memberId='consumer-deepreach-translation-v2-2-058a019c-f582-426c-93ca-226bacb79e03', protocol='range'}
2025-11-11 19:53:32 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Notifying assignor about the new Assignment(partitions=[translation-charge-1])
2025-11-11 19:53:32 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Adding newly assigned partitions: translation-charge-1
2025-11-11 19:53:32 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Setting offset for partition translation-charge-1 to the committed offset FetchPosition{offset=8, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[206.82.1.18:9092 (id: 1 rack: null)], epoch=0}}
2025-11-11 19:53:32 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions assigned: [translation-charge-1]
2025-11-11 19:53:43 [main] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-11-11 19:53:43 [main] INFO  c.d.web.config.DataSourceHealthCheck - 主数据源连接成功: PRIMARY_OK
2025-11-11 19:53:45 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据源连接成功: CLOUD_COMPUTER_OK
2025-11-11 19:53:47 [main] INFO  c.d.web.config.DataSourceHealthCheck - 云电脑数据库中admin用户记录数: 0
2025-11-11 19:53:47 [main] INFO  c.d.web.config.DataSourceHealthCheck - 数据源检查完成
2025-11-11 19:53:47 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 开始构建用户层级树缓存...
2025-11-11 19:53:47 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==>  Preparing: SELECT u.user_id AS userId, u.parent_user_id AS parentUserId FROM sys_user u WHERE u.status = '0'
2025-11-11 19:53:47 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - ==> Parameters: 
2025-11-11 19:53:47 [main] DEBUG c.d.c.c.m.S.selectAllUserHierarchyRelations - <==      Total: 72
2025-11-11 19:53:48 [main] INFO  c.d.c.c.s.impl.SysUserServiceImpl - 用户层级树缓存刷新成功：记录总数=72, 根节点数量=1
2025-11-11 19:53:48 [main] INFO  c.d.w.i.UserHierarchyCacheInitializer - 用户层级树缓存构建完成
2025-11-11 19:54:58 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-11 19:54:58 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-11 19:54:58 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 4 ms
2025-11-11 19:54:58 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 19:54:58 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 19:54:58 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 19:54:58 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 19:54:58 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 19:54:58 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:54:58 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 19:54:58 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 19:54:58 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:54:58 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 19:54:58 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 19:54:58 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 19:54:58 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 19:54:59 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 19:54:59 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 19:54:59 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 19:54:59 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 19:54:59 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 19:54:59 [http-nio-8080-exec-2] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 19:54:59 [http-nio-8080-exec-2] WARN  o.s.w.s.h.HandlerMappingIntrospector - Cache miss for REQUEST dispatch to '/api/translate' (previous null). Performing MatchableHandlerMapping lookup. This is logged once only at WARN level, and every time at TRACE.
2025-11-11 19:54:59 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 19:54:59 [http-nio-8080-exec-2] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 19:54:59 [http-nio-8080-exec-2] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-0
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-0
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:54:59 [http-nio-8080-exec-2] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Instantiated a transactional producer.
2025-11-11 19:54:59 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:54:59 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:54:59 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762862099430
2025-11-11 19:54:59 [http-nio-8080-exec-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:55:00 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:55:00 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:55:00 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] ProducerId set to 0 with epoch 9
2025-11-11 19:55:00 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:55:00 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:55:00 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:55:00 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:55:00 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 19:55:01 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:55:01 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:55:01 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 19:55:01 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:55:01 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:55:01 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 19:55:01 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:55:01 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:55:01 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 19:55:01 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:55:01 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:55:01 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:55:01 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:55:03 [http-nio-8080-exec-2] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 117 tokens
2025-11-11 19:55:03 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 19:55:03 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if it's this interface 😈(String), en(String)
2025-11-11 19:55:03 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 19:55:03 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:55:03 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:55:03 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:55:03 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 19:55:03 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 19:55:03 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 19:55:04 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:55:04 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 19:55:04 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:55:04 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:55:04 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 19:55:04 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:55:04 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 19:55:04 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 19:55:04 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 19:55:04 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 19:55:04 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 19:55:05 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 19:55:05 [http-nio-8080-exec-2] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [206.82.1.18:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-deepreach-translate-tx-1
	compression.type = zstd
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 10
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = deepreach-translate-tx-1
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-11-11 19:55:05 [http-nio-8080-exec-2] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Instantiated a transactional producer.
2025-11-11 19:55:05 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.6.0
2025-11-11 19:55:05 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 60e845626d8a465a
2025-11-11 19:55:05 [http-nio-8080-exec-2] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1762862105138
2025-11-11 19:55:05 [http-nio-8080-exec-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Invoking InitProducerId for the first time in order to acquire a producer ID
2025-11-11 19:55:06 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Cluster ID: MkU3OEVBNTcwNTJENDM2Qg
2025-11-11 19:55:06 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Discovered transaction coordinator 206.82.1.18:9092 (id: 1 rack: null)
2025-11-11 19:55:06 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] ProducerId set to 1 with epoch 9
2025-11-11 19:55:07 [http-nio-8080-exec-2] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=e818644b-afb6-4e46-a3d5-b9606efa5e20, amount=0.000117
2025-11-11 19:55:07 [http-nio-8080-exec-2] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=117, amount=0.000117
2025-11-11 19:55:07 [http-nio-8080-exec-2] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=117
2025-11-11 19:55:07 [http-nio-8080-exec-2] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 8430ms
2025-11-11 19:55:07 [http-nio-8080-exec-2] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 8430ms - 超过阈值: 3000ms
2025-11-11 19:55:07 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:55:07 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:55:08 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:55:08 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 19:55:08 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.095679(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.904321(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.139821(BigDecimal), 342(Long), 1270(Integer)
2025-11-11 19:55:08 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 19:55:08 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 19:55:08 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 19:55:08 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 19:55:08 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=e818644b-afb6-4e46-a3d5-b9606efa5e20 chargeUserId=342 amount=0.000117
2025-11-11 20:01:11 [http-nio-8080-exec-4] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 20:01:11 [http-nio-8080-exec-4] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 20:01:11 [http-nio-8080-exec-4] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 20:01:11 [http-nio-8080-exec-4] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 20:01:11 [http-nio-8080-exec-4] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 20:01:11 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:01:11 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 20:01:11 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 20:01:11 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:01:11 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 20:01:11 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 20:01:11 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 20:01:11 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 20:01:12 [http-nio-8080-exec-4] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:01:12 [http-nio-8080-exec-4] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:01:13 [http-nio-8080-exec-4] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:01:15 [http-nio-8080-exec-4] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 118 tokens
2025-11-11 20:01:15 [http-nio-8080-exec-4] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 20:01:15 [http-nio-8080-exec-4] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if this is the correct one 😈(String), en(String)
2025-11-11 20:01:15 [http-nio-8080-exec-4] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 20:01:15 [http-nio-8080-exec-4] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:01:15 [http-nio-8080-exec-4] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:01:16 [http-nio-8080-exec-4] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:01:16 [http-nio-8080-exec-4] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:01:16 [http-nio-8080-exec-4] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:01:16 [http-nio-8080-exec-4] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:01:16 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:01:16 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:01:16 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:01:16 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:01:16 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:01:16 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:01:16 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:01:16 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:01:16 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:01:16 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:01:16 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:01:16 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:01:17 [http-nio-8080-exec-4] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=fb2458f1-724b-48a6-862d-585ec72fb5d8, amount=0.000118
2025-11-11 20:01:17 [http-nio-8080-exec-4] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=118, amount=0.000118
2025-11-11 20:01:17 [http-nio-8080-exec-4] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=118
2025-11-11 20:01:17 [http-nio-8080-exec-4] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 5429ms
2025-11-11 20:01:17 [http-nio-8080-exec-4] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 5429ms - 超过阈值: 3000ms
2025-11-11 20:01:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:01:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:01:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:01:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 20:01:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.095561(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.904439(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.139939(BigDecimal), 342(Long), 1271(Integer)
2025-11-11 20:01:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 20:01:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:01:17 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:01:18 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:01:18 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=fb2458f1-724b-48a6-862d-585ec72fb5d8 chargeUserId=342 amount=0.000118
2025-11-11 20:01:35 [http-nio-8080-exec-6] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 20:01:35 [http-nio-8080-exec-6] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 20:01:35 [http-nio-8080-exec-6] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 20:01:35 [http-nio-8080-exec-6] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 20:01:35 [http-nio-8080-exec-6] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 20:01:35 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:01:35 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 20:01:35 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 20:01:35 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:01:35 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 20:01:35 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 20:01:35 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 20:01:35 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 20:01:36 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 20:01:36 [http-nio-8080-exec-6] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 20:01:36 [http-nio-8080-exec-6] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 20:01:36 [http-nio-8080-exec-6] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 20:01:36 [http-nio-8080-exec-6] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 20:01:36 [http-nio-8080-exec-6] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 20:01:36 [http-nio-8080-exec-6] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 20:01:36 [http-nio-8080-exec-6] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 20:01:36 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:01:36 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:01:36 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:01:36 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:01:36 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:01:36 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:01:36 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:01:36 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:01:37 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:01:37 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:01:37 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:01:37 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:01:37 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:01:37 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:01:37 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:01:37 [http-nio-8080-exec-6] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:01:37 [http-nio-8080-exec-6] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:01:37 [http-nio-8080-exec-6] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:01:38 [http-nio-8080-exec-6] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 117 tokens
2025-11-11 20:01:38 [http-nio-8080-exec-6] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 20:01:38 [http-nio-8080-exec-6] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if it's this interface 😈(String), en(String)
2025-11-11 20:01:39 [http-nio-8080-exec-6] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 20:01:39 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:01:39 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:01:39 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:01:39 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:01:39 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:01:39 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:01:39 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:01:39 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:01:40 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:01:40 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:01:40 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:01:40 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:01:40 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:01:40 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:01:40 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:01:40 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:01:40 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:01:40 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:01:40 [http-nio-8080-exec-6] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=ce9085d0-cc5f-4582-81c0-8771b1d0dbcf, amount=0.000117
2025-11-11 20:01:40 [http-nio-8080-exec-6] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=117, amount=0.000117
2025-11-11 20:01:40 [http-nio-8080-exec-6] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=117
2025-11-11 20:01:40 [http-nio-8080-exec-6] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 4861ms
2025-11-11 20:01:40 [http-nio-8080-exec-6] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 4861ms - 超过阈值: 3000ms
2025-11-11 20:01:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:01:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:01:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:01:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 20:01:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.095444(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.904556(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.140056(BigDecimal), 342(Long), 1272(Integer)
2025-11-11 20:01:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 20:01:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:01:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:01:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:01:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=ce9085d0-cc5f-4582-81c0-8771b1d0dbcf chargeUserId=342 amount=0.000117
2025-11-11 20:02:15 [http-nio-8080-exec-7] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 20:02:15 [http-nio-8080-exec-7] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 20:02:15 [http-nio-8080-exec-7] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 20:02:15 [http-nio-8080-exec-7] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 20:02:15 [http-nio-8080-exec-7] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 20:02:15 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:02:15 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 20:02:15 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 20:02:15 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:02:15 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 20:02:16 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 20:02:16 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 20:02:16 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 20:02:16 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 20:02:16 [http-nio-8080-exec-7] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 20:02:16 [http-nio-8080-exec-7] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 20:02:16 [http-nio-8080-exec-7] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 20:02:16 [http-nio-8080-exec-7] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 20:02:16 [http-nio-8080-exec-7] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 20:02:16 [http-nio-8080-exec-7] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 20:02:16 [http-nio-8080-exec-7] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 20:02:16 [http-nio-8080-exec-7] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:02:16 [http-nio-8080-exec-7] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:02:16 [http-nio-8080-exec-7] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:02:16 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:02:16 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:02:17 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:02:17 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:02:17 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:02:17 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:02:17 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:02:17 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:02:17 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:02:17 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:02:17 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:02:17 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:02:17 [http-nio-8080-exec-7] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:02:17 [http-nio-8080-exec-7] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:02:17 [http-nio-8080-exec-7] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:02:23 [http-nio-8080-exec-7] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 118 tokens
2025-11-11 20:02:23 [http-nio-8080-exec-7] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 20:02:23 [http-nio-8080-exec-7] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if this is the correct one 😈(String), en(String)
2025-11-11 20:02:24 [http-nio-8080-exec-7] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 20:02:24 [http-nio-8080-exec-7] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:02:24 [http-nio-8080-exec-7] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:02:25 [http-nio-8080-exec-7] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:02:25 [http-nio-8080-exec-7] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:02:25 [http-nio-8080-exec-7] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:02:25 [http-nio-8080-exec-7] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:02:25 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:02:25 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:02:25 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:02:25 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:02:25 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:02:25 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:02:25 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:02:25 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:02:26 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:02:26 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:02:26 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:02:26 [http-nio-8080-exec-7] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:02:26 [http-nio-8080-exec-7] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=48346357-4a38-4386-9e4b-1b2cb35c5971, amount=0.000118
2025-11-11 20:02:26 [http-nio-8080-exec-7] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=118, amount=0.000118
2025-11-11 20:02:26 [http-nio-8080-exec-7] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=118
2025-11-11 20:02:26 [http-nio-8080-exec-7] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 9922ms
2025-11-11 20:02:26 [http-nio-8080-exec-7] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 9922ms - 超过阈值: 3000ms
2025-11-11 20:02:26 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:02:26 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:02:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:02:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 20:02:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.095326(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.904674(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.140174(BigDecimal), 342(Long), 1273(Integer)
2025-11-11 20:02:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 20:02:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:02:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:02:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:02:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=48346357-4a38-4386-9e4b-1b2cb35c5971 chargeUserId=342 amount=0.000118
2025-11-11 20:02:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Node -1 disconnected.
2025-11-11 20:02:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Node -1 disconnected.
2025-11-11 20:02:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Node -1 disconnected.
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 20:02:29 [http-nio-8080-exec-8] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:02:29 [http-nio-8080-exec-8] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:02:30 [http-nio-8080-exec-8] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:02:30 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:02:30 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:02:30 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:02:30 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:02:30 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:02:30 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:02:30 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:02:30 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:02:30 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:02:30 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:02:30 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:02:31 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:02:31 [http-nio-8080-exec-8] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:02:31 [http-nio-8080-exec-8] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:02:31 [http-nio-8080-exec-8] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:02:32 [http-nio-8080-exec-8] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 118 tokens
2025-11-11 20:02:32 [http-nio-8080-exec-8] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 20:02:32 [http-nio-8080-exec-8] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if this is the correct one 😈(String), en(String)
2025-11-11 20:02:32 [http-nio-8080-exec-8] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 20:02:32 [http-nio-8080-exec-8] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:02:32 [http-nio-8080-exec-8] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:02:32 [http-nio-8080-exec-8] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:02:32 [http-nio-8080-exec-8] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:02:32 [http-nio-8080-exec-8] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:02:33 [http-nio-8080-exec-8] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:02:33 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:02:33 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:02:33 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:02:33 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:02:33 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:02:33 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:02:33 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:02:33 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:02:34 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:02:34 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:02:34 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:02:35 [http-nio-8080-exec-8] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:02:35 [http-nio-8080-exec-8] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=734af54d-6adf-405d-b917-952c72a34bb0, amount=0.000118
2025-11-11 20:02:35 [http-nio-8080-exec-8] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=118, amount=0.000118
2025-11-11 20:02:35 [http-nio-8080-exec-8] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=118
2025-11-11 20:02:35 [http-nio-8080-exec-8] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 5595ms
2025-11-11 20:02:35 [http-nio-8080-exec-8] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 5595ms - 超过阈值: 3000ms
2025-11-11 20:02:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:02:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:02:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:02:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 20:02:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.095208(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.904792(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.140292(BigDecimal), 342(Long), 1274(Integer)
2025-11-11 20:02:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 20:02:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:02:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:02:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:02:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=734af54d-6adf-405d-b917-952c72a34bb0 chargeUserId=342 amount=0.000118
2025-11-11 20:02:43 [http-nio-8080-exec-9] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 20:02:43 [http-nio-8080-exec-9] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 20:02:43 [http-nio-8080-exec-9] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 20:02:43 [http-nio-8080-exec-9] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 20:02:43 [http-nio-8080-exec-9] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 20:02:43 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:02:43 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 20:02:43 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 20:02:43 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:02:43 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 20:02:44 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 20:02:44 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 20:02:44 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 20:02:44 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 20:02:44 [http-nio-8080-exec-9] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 20:02:44 [http-nio-8080-exec-9] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 20:02:44 [http-nio-8080-exec-9] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 20:02:44 [http-nio-8080-exec-9] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 20:02:44 [http-nio-8080-exec-9] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 20:02:44 [http-nio-8080-exec-9] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 20:02:44 [http-nio-8080-exec-9] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 20:02:44 [http-nio-8080-exec-9] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:02:44 [http-nio-8080-exec-9] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:02:44 [http-nio-8080-exec-9] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:02:44 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:02:44 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:02:44 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:02:44 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:02:44 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:02:45 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:02:45 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:02:45 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:02:45 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:02:45 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:02:45 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:02:45 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:02:45 [http-nio-8080-exec-9] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:02:45 [http-nio-8080-exec-9] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:02:45 [http-nio-8080-exec-9] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:02:46 [http-nio-8080-exec-9] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 121 tokens
2025-11-11 20:02:46 [http-nio-8080-exec-9] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 20:02:46 [http-nio-8080-exec-9] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if this is the correct one? 😈(String), en(String)
2025-11-11 20:02:47 [http-nio-8080-exec-9] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 20:02:47 [http-nio-8080-exec-9] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:02:47 [http-nio-8080-exec-9] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:02:47 [http-nio-8080-exec-9] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:02:47 [http-nio-8080-exec-9] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:02:47 [http-nio-8080-exec-9] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:02:47 [http-nio-8080-exec-9] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:02:47 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:02:47 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:02:48 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:02:48 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:02:48 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:02:48 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:02:48 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:02:48 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:02:49 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:02:49 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:02:49 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:02:49 [http-nio-8080-exec-9] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:02:50 [http-nio-8080-exec-9] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=fc53cfb3-a3b3-4d39-a3ea-b64e5278a303, amount=0.000121
2025-11-11 20:02:50 [http-nio-8080-exec-9] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=121, amount=0.000121
2025-11-11 20:02:50 [http-nio-8080-exec-9] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=121
2025-11-11 20:02:50 [http-nio-8080-exec-9] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 6056ms
2025-11-11 20:02:50 [http-nio-8080-exec-9] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 6056ms - 超过阈值: 3000ms
2025-11-11 20:02:50 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:02:50 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:02:50 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:02:50 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 20:02:50 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.095087(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.904913(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.140413(BigDecimal), 342(Long), 1275(Integer)
2025-11-11 20:02:50 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 20:02:50 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:02:50 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:02:50 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:02:50 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=fc53cfb3-a3b3-4d39-a3ea-b64e5278a303 chargeUserId=342 amount=0.000121
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 20:03:21 [http-nio-8080-exec-10] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:03:21 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:03:22 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:03:22 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:03:22 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:03:22 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:03:22 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:03:22 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:03:22 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:03:22 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:03:22 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:03:22 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:03:22 [http-nio-8080-exec-10] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:03:22 [http-nio-8080-exec-10] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:03:22 [http-nio-8080-exec-10] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:03:24 [http-nio-8080-exec-10] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 119 tokens
2025-11-11 20:03:24 [http-nio-8080-exec-10] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 20:03:24 [http-nio-8080-exec-10] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if this is the right one? 😈(String), en(String)
2025-11-11 20:03:25 [http-nio-8080-exec-10] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 20:03:25 [http-nio-8080-exec-10] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:03:25 [http-nio-8080-exec-10] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:03:25 [http-nio-8080-exec-10] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:03:25 [http-nio-8080-exec-10] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:03:25 [http-nio-8080-exec-10] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:03:25 [http-nio-8080-exec-10] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:03:25 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:03:25 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:03:25 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:03:25 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:03:25 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:03:26 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:03:26 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:03:26 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:03:26 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:03:26 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:03:26 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:03:26 [http-nio-8080-exec-10] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:03:27 [http-nio-8080-exec-10] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=f0e9dbff-ca2a-4a6b-982c-bcfc65730b97, amount=0.000119
2025-11-11 20:03:27 [http-nio-8080-exec-10] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=119, amount=0.000119
2025-11-11 20:03:27 [http-nio-8080-exec-10] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=119
2025-11-11 20:03:27 [http-nio-8080-exec-10] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 5382ms
2025-11-11 20:03:27 [http-nio-8080-exec-10] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 5382ms - 超过阈值: 3000ms
2025-11-11 20:03:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:03:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:03:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:03:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 20:03:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.094968(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.905032(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.140532(BigDecimal), 342(Long), 1276(Integer)
2025-11-11 20:03:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 20:03:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:03:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:03:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:03:27 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=f0e9dbff-ca2a-4a6b-982c-bcfc65730b97 chargeUserId=342 amount=0.000119
2025-11-11 20:03:29 [http-nio-8080-exec-1] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 20:03:29 [http-nio-8080-exec-1] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 20:03:29 [http-nio-8080-exec-1] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 20:03:29 [http-nio-8080-exec-1] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 20:03:29 [http-nio-8080-exec-1] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 20:03:29 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:03:29 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 20:03:30 [http-nio-8080-exec-1] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:03:30 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:03:31 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:03:31 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:03:31 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:03:31 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:03:31 [http-nio-8080-exec-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:03:31 [http-nio-8080-exec-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:03:31 [http-nio-8080-exec-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:03:33 [http-nio-8080-exec-1] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 117 tokens
2025-11-11 20:03:33 [http-nio-8080-exec-1] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 20:03:33 [http-nio-8080-exec-1] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if it's this interface 😈(String), en(String)
2025-11-11 20:03:33 [http-nio-8080-exec-1] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 20:03:33 [http-nio-8080-exec-1] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:03:33 [http-nio-8080-exec-1] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:03:33 [http-nio-8080-exec-1] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:03:33 [http-nio-8080-exec-1] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:03:33 [http-nio-8080-exec-1] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:03:33 [http-nio-8080-exec-1] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:03:33 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:03:34 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:03:34 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:03:34 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:03:34 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:03:34 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:03:34 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:03:34 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:03:34 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:03:34 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:03:34 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:03:34 [http-nio-8080-exec-1] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:03:34 [http-nio-8080-exec-1] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=c518fa67-fe7c-498a-8409-a3e26f0fd12d, amount=0.000117
2025-11-11 20:03:35 [http-nio-8080-exec-1] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=117, amount=0.000117
2025-11-11 20:03:35 [http-nio-8080-exec-1] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=117
2025-11-11 20:03:35 [http-nio-8080-exec-1] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 4707ms
2025-11-11 20:03:35 [http-nio-8080-exec-1] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 4707ms - 超过阈值: 3000ms
2025-11-11 20:03:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:03:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:03:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:03:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 20:03:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.094851(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.905149(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.140649(BigDecimal), 342(Long), 1277(Integer)
2025-11-11 20:03:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 20:03:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:03:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:03:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:03:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=c518fa67-fe7c-498a-8409-a3e26f0fd12d chargeUserId=342 amount=0.000117
2025-11-11 20:03:37 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 20:03:37 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 20:03:37 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 20:03:37 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 20:03:37 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 20:03:37 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:03:37 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 20:03:37 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 20:03:37 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:03:37 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 20:03:37 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 20:03:37 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 20:03:37 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 20:03:37 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 20:03:37 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 20:03:37 [http-nio-8080-exec-2] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 20:03:37 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 20:03:38 [http-nio-8080-exec-2] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:03:38 [http-nio-8080-exec-2] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:03:40 [http-nio-8080-exec-2] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 118 tokens
2025-11-11 20:03:40 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 20:03:40 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if this is the right one 😈(String), en(String)
2025-11-11 20:03:41 [http-nio-8080-exec-2] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 20:03:41 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:03:41 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:03:41 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:03:41 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:03:41 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:03:41 [http-nio-8080-exec-2] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:03:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:03:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:03:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:03:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:03:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:03:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:03:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:03:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:03:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:03:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:03:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:03:41 [http-nio-8080-exec-2] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:03:42 [http-nio-8080-exec-2] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=8b1ace84-1418-479c-92c8-aeb2b55aad57, amount=0.000118
2025-11-11 20:03:42 [http-nio-8080-exec-2] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=118, amount=0.000118
2025-11-11 20:03:42 [http-nio-8080-exec-2] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=118
2025-11-11 20:03:42 [http-nio-8080-exec-2] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 4394ms
2025-11-11 20:03:42 [http-nio-8080-exec-2] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 4394ms - 超过阈值: 3000ms
2025-11-11 20:03:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:03:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:03:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:03:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 20:03:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.094733(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.905267(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.140767(BigDecimal), 342(Long), 1278(Integer)
2025-11-11 20:03:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 20:03:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:03:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:03:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:03:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=8b1ace84-1418-479c-92c8-aeb2b55aad57 chargeUserId=342 amount=0.000118
2025-11-11 20:04:12 [kafka-producer-network-thread | producer-deepreach-translate-tx-0] INFO  o.apache.kafka.clients.NetworkClient - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Node -1 disconnected.
2025-11-11 20:04:13 [kafka-producer-network-thread | producer-deepreach-translate-tx-1] INFO  o.apache.kafka.clients.NetworkClient - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Node -1 disconnected.
2025-11-11 20:06:04 [http-nio-8080-exec-4] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 20:06:04 [http-nio-8080-exec-4] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 20:06:04 [http-nio-8080-exec-4] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 20:06:04 [http-nio-8080-exec-4] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 20:06:04 [http-nio-8080-exec-4] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 20:06:04 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:06:04 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 20:06:05 [http-nio-8080-exec-4] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:06:05 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:06:06 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:06:06 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:06:06 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:06:06 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:06:06 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:06:06 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:06:06 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:06:06 [http-nio-8080-exec-4] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:06:06 [http-nio-8080-exec-4] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:06:06 [http-nio-8080-exec-4] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:06:08 [http-nio-8080-exec-4] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 119 tokens
2025-11-11 20:06:08 [http-nio-8080-exec-4] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 20:06:08 [http-nio-8080-exec-4] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if this is the right one? 😈(String), en(String)
2025-11-11 20:06:08 [http-nio-8080-exec-4] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 20:06:08 [http-nio-8080-exec-4] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:06:08 [http-nio-8080-exec-4] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:06:08 [http-nio-8080-exec-4] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:06:08 [http-nio-8080-exec-4] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:06:08 [http-nio-8080-exec-4] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:06:08 [http-nio-8080-exec-4] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:06:08 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:06:08 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:06:09 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:06:09 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:06:09 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:06:09 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:06:09 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:06:09 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:06:09 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:06:09 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:06:09 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:06:09 [http-nio-8080-exec-4] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:06:09 [http-nio-8080-exec-4] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=8ef79d6e-7c67-469c-94be-656241781237, amount=0.000119
2025-11-11 20:06:10 [http-nio-8080-exec-4] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=119, amount=0.000119
2025-11-11 20:06:10 [http-nio-8080-exec-4] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=119
2025-11-11 20:06:10 [http-nio-8080-exec-4] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 4372ms
2025-11-11 20:06:10 [http-nio-8080-exec-4] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 4372ms - 超过阈值: 3000ms
2025-11-11 20:06:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:06:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:06:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:06:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 20:06:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.094614(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.905386(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.140886(BigDecimal), 342(Long), 1279(Integer)
2025-11-11 20:06:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 20:06:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:06:10 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:06:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:06:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=8ef79d6e-7c67-469c-94be-656241781237 chargeUserId=342 amount=0.000119
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG o.s.security.web.FilterChainProxy - Securing POST /translate
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.s.JwtAuthenticationFilter - 从请求中提取到Token: eyJhbGciOiJIUzI1NiJ9...
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.s.JwtAuthenticationFilter - 从Token中解析出用户名: anan
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.s.JwtAuthenticationFilter - 开始加载用户详情: anan
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.s.UserDetailsServiceImpl - 正在加载用户详情: anan
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.username = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - ==> Parameters: anan(String)
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithRolesAndPermissions - <==      Total: 1
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==>  Preparing: SELECT DISTINCT r.role_id, r.role_name, r.role_key, r.role_sort, r.data_scope, r.status, r.del_flag, r.create_time, r.update_time FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRolesByUserId - ==> Parameters: 347(Long)
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRolesByUserId - <==      Total: 1
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==>  Preparing: SELECT DISTINCT m.perms FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role_menu rm ON ur.role_id = rm.role_id LEFT JOIN sys_menu m ON rm.menu_id = m.menu_id WHERE u.user_id = ? AND u.status = '0' AND m.status = 0 AND m.perms IS NOT NULL AND m.perms != ''
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - ==> Parameters: 347(Long)
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectPermissionsByUserId - <==      Total: 10
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.s.UserDetailsServiceImpl - 普通用户 anan 获取权限: 10
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.s.UserDetailsServiceImpl - 用户详情加载成功: anan, 角色: 1, 权限数量: 10
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.s.JwtAuthenticationFilter - 用户详情加载成功: anan
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.s.JwtAuthenticationFilter - Token验证结果: true
2025-11-11 20:06:25 [http-nio-8080-exec-6] INFO  c.d.c.s.JwtAuthenticationFilter - 用户 anan 认证成功
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG o.s.security.web.FilterChainProxy - Secured POST /translate
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.i.PerformanceInterceptor - 开始处理请求: POST /api/translate from 127.0.0.1
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:06:25 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:06:26 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:06:26 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:06:26 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:06:26 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:06:26 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:06:26 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:06:26 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:06:26 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:06:26 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:06:26 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:06:26 [http-nio-8080-exec-6] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:06:26 [http-nio-8080-exec-6] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:06:26 [http-nio-8080-exec-6] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:06:28 [http-nio-8080-exec-6] DEBUG c.d.t.client.DashScopeChatClient - DashScope model qwen-plus consumed 119 tokens
2025-11-11 20:06:28 [http-nio-8080-exec-6] DEBUG c.d.t.m.T.insert - ==>  Preparing: INSERT INTO translated_messages (user_id, original_text, sent_text, self_language_code) VALUES (?, ?, ?, ?)
2025-11-11 20:06:28 [http-nio-8080-exec-6] DEBUG c.d.t.m.T.insert - ==> Parameters: 347(Long), 会不会我那时候接错接口了，你看看是不是这个接口😈(String), Could it be that I connected the wrong interface back then? Could you check if it's this interface 😈(String), en(String)
2025-11-11 20:06:28 [http-nio-8080-exec-6] DEBUG c.d.t.m.T.insert - <==    Updates: 1
2025-11-11 20:06:28 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:06:28 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:06:28 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:06:28 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==>  Preparing: select price_id, business_type, business_name, price_unit, dr_price, billing_type, status, create_time, update_time, create_by, update_by, remark from dr_price_config where business_type = ?
2025-11-11 20:06:28 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - ==> Parameters: TOKEN(String)
2025-11-11 20:06:28 [http-nio-8080-exec-6] DEBUG c.d.w.m.D.selectDrPriceConfigByBusinessType - <==      Total: 1
2025-11-11 20:06:28 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:06:28 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 347(Long)
2025-11-11 20:06:28 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:06:28 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:06:28 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 347(Long)
2025-11-11 20:06:29 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:06:29 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==>  Preparing: SELECT u.user_id, u.username, u.password, u.nickname, u.real_name, u.email, u.phone, u.gender, u.avatar, u.user_type, u.status, u.dept_id, u.parent_user_id, u.invitation_code, u.login_ip, u.login_time, u.create_by, u.create_time, u.update_by, u.update_time, u.remark, d.dept_id, d.parent_id, d.ancestors, d.dept_name, d.order_num as dept_order_num, d.leader as dept_leader, d.phone as dept_phone, d.email as dept_email, d.status as dept_status, d.del_flag as dept_del_flag, d.level, d.leader_user_id AS leader_id, leader.nickname AS leader_nickname, parent.username AS parent_username, parent_roles.parent_role_keys, r.role_key FROM sys_user u LEFT JOIN sys_dept d ON u.dept_id = d.dept_id AND d.del_flag = '0' LEFT JOIN sys_user leader ON d.leader_user_id = leader.user_id LEFT JOIN sys_user parent ON u.parent_user_id = parent.user_id LEFT JOIN ( SELECT pur.user_id, GROUP_CONCAT(DISTINCT sr.role_key ORDER BY sr.role_key) AS parent_role_keys FROM sys_user_role pur JOIN sys_role sr ON pur.role_id = sr.role_id AND sr.del_flag = '0' GROUP BY pur.user_id ) parent_roles ON parent.user_id = parent_roles.user_id LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id AND r.del_flag = '0' WHERE u.user_id = ? AND u.status = '0' ORDER BY r.role_sort
2025-11-11 20:06:29 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - ==> Parameters: 342(Long)
2025-11-11 20:06:29 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectUserWithDept - <==      Total: 1
2025-11-11 20:06:29 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==>  Preparing: SELECT DISTINCT r.role_key FROM sys_user u LEFT JOIN sys_user_role ur ON u.user_id = ur.user_id LEFT JOIN sys_role r ON ur.role_id = r.role_id WHERE u.user_id = ? AND u.status = '0' AND r.status = '0' AND r.del_flag = '0'
2025-11-11 20:06:29 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - ==> Parameters: 342(Long)
2025-11-11 20:06:29 [http-nio-8080-exec-6] DEBUG c.d.c.c.m.S.selectRoleKeysByUserId - <==      Total: 1
2025-11-11 20:06:29 [http-nio-8080-exec-6] DEBUG c.d.t.mq.TranslationChargeProducer - Published translation charge event to topic=translation-charge, key=be45e22a-fa0b-4d56-8b45-86d74b89ae17, amount=0.000119
2025-11-11 20:06:29 [http-nio-8080-exec-6] INFO  c.d.t.s.i.TranslationBillingServiceImpl - 翻译扣费事件已入队，requestUserId=347, chargeUserId=342, tokens=119, amount=0.000119
2025-11-11 20:06:29 [http-nio-8080-exec-6] INFO  c.d.t.s.impl.TranslationServiceImpl - Translation success userId=347 channel=qwen-plus tokens=119
2025-11-11 20:06:29 [http-nio-8080-exec-6] INFO  c.d.c.i.PerformanceInterceptor - 请求处理完成: POST /api/translate from 127.0.0.1 - 状态: 200 - 耗时: 4061ms
2025-11-11 20:06:29 [http-nio-8080-exec-6] WARN  c.d.c.i.PerformanceInterceptor - 检测到慢请求: POST /api/translate from 127.0.0.1 - 耗时: 4061ms - 超过阈值: 3000ms
2025-11-11 20:06:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:06:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:06:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:06:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==>  Preparing: update user_dr_balance set dr_balance = ?, pre_deducted_balance = ?, total_recharge = ?, total_consume = ?, total_refund = ?, frozen_amount = ?, daily_consume = ?, version = version + 1, update_time = now() where user_id = ? and version = ?
2025-11-11 20:06:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - ==> Parameters: 8378.094495(BigDecimal), 0.000000(BigDecimal), 10000.000000(BigDecimal), 1621.905505(BigDecimal), 0.000000(BigDecimal), 0.000000(BigDecimal), 0.141005(BigDecimal), 342(Long), 1280(Integer)
2025-11-11 20:06:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.updateBalanceWithVersion - <==    Updates: 1
2025-11-11 20:06:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==>  Preparing: select balance_id, user_id, dr_balance, pre_deducted_balance, total_recharge, total_consume, total_refund, frozen_amount, daily_consume, version, status, ai_character_free_times, create_by, create_time, update_by, update_time, remark from user_dr_balance where user_id = ?
2025-11-11 20:06:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - ==> Parameters: 342(Long)
2025-11-11 20:06:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.w.m.U.selectByUserId - <==      Total: 1
2025-11-11 20:06:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG c.d.web.mq.TranslationChargeConsumer - 翻译扣费事件消费成功 eventId=be45e22a-fa0b-4d56-8b45-86d74b89ae17 chargeUserId=342 amount=0.000119
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Revoke previously assigned partitions translation-charge-1
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Revoke previously assigned partitions translation-charge-0
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Revoke previously assigned partitions translation-charge-2
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions revoked: [translation-charge-1]
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions revoked: [translation-charge-0]
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: partitions revoked: [translation-charge-2]
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Member consumer-deepreach-translation-v2-1-c8026b68-72e9-4a39-9b9a-2bde6300391d sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Member consumer-deepreach-translation-v2-2-058a019c-f582-426c-93ca-226bacb79e03 sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Member consumer-deepreach-translation-v2-3-d83d9ae9-3d9a-428d-9e4f-4fb5b20e3368 sending LeaveGroup request to coordinator 206.82.1.18:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.c.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Unsubscribed all topics or patterns and assigned partitions
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-3, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-2, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-deepreach-translation-v2-1, groupId=deepreach-translation-v2] Request joining group due to: consumer pro-actively leaving the group
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-v2-3 unregistered
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: Consumer stopped
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-v2-1 unregistered
2025-11-11 20:07:43 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: Consumer stopped
2025-11-11 20:07:44 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 20:07:44 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 20:07:44 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 20:07:44 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-deepreach-translation-v2-2 unregistered
2025-11-11 20:07:44 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  o.s.k.l.KafkaMessageListenerContainer - deepreach-translation-v2: Consumer stopped
2025-11-11 20:07:44 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-0, transactionalId=deepreach-translate-tx-0] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 20:07:44 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 20:07:44 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 20:07:44 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 20:07:44 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-0 unregistered
2025-11-11 20:07:44 [SpringApplicationShutdownHook] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-deepreach-translate-tx-1, transactionalId=deepreach-translate-tx-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-11-11 20:07:44 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-11-11 20:07:44 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-11-11 20:07:44 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-11-11 20:07:44 [SpringApplicationShutdownHook] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.producer for producer-deepreach-translate-tx-1 unregistered
2025-11-11 20:07:44 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-11-11 20:07:44 [SpringApplicationShutdownHook] INFO  c.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
